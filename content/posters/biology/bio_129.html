<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seed Dispersal Mechanisms</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background: #0284c7; color: white; min-height: 100vh; font-family: 'Inter'; }
        .glass { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); backdrop-filter: blur(10px); }
        .rounded-custom { border-radius: 2rem; }
        canvas { cursor: pointer; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body class="p-8">

<!-- –ö–ù–û–ü–ö–ê –ù–ê–ó–ê–î -->
<div style="position: fixed; top: 20px; left: 20px; z-index: 10000;">
    <button onclick="goBack()" style="
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 12px 24px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        transition: all 0.3s ease;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    " onmouseover="this.style.transform='translateX(-5px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.6)';" 
       onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)';">
        ‚Üê –ù–∞–∑–∞–¥
    </button>
</div>


    <header class="flex justify-between items-center mb-8">
        <h1 class="text-4xl font-bold text-white">SEED DISPERSAL</h1>
        <div class="flex gap-2">
            <button onclick="setMode('wind')" class="bg-white/20 px-4 py-2 rounded hover:bg-white/40">üí® Anemochory</button>
            <button onclick="setMode('animal')" class="bg-white/20 px-4 py-2 rounded hover:bg-white/40">üêæ Zoochory</button>
            <button onclick="setMode('self')" class="bg-white/20 px-4 py-2 rounded hover:bg-white/40">üí• Autochory</button>
        </div>
    </header>

    <div class="glass rounded-custom h-[600px] relative overflow-hidden">
        <canvas id="dispCanvas" class="w-full h-full"></canvas>
        <div class="absolute bottom-8 left-8 text-2xl font-bold opacity-50" id="mode-text">WIND</div>
    </div>

    <script>
        let mode = 'wind';
        let cx, cvs;
        let particles = [];

        window.setMode = (m) => {
            mode = m; 
            document.getElementById('mode-text').textContent = m.toUpperCase();
            initParticles();
        }

        function initParticles() {
            particles = [];
            const count = mode === 'wind' ? 50 : (mode === 'self' ? 20 : 1);
            for(let i=0; i<count; i++) {
                particles.push({
                    x: mode === 'self' ? cvs.width/2 : Math.random()*cvs.width,
                    y: mode === 'self' ? cvs.height/2 : Math.random()*cvs.height,
                    vx: (Math.random()-0.5) * (mode === 'self' ? 20 : 2),
                    vy: (Math.random()-0.5) * (mode === 'self' ? 20 : 2),
                    r: mode === 'animal' ? 20 : 3
                });
            }
        }

        function draw() {
            const w = cvs.width, h = cvs.height;
            cx.clearRect(0,0,w,h);

            // Ground
            cx.fillStyle = '#0f172a'; cx.fillRect(0, h*0.8, w, h*0.2);

            if(mode === 'wind') { // Dandelion
                particles.forEach(p => {
                    p.x += p.vx + 2; p.y += p.vy; // Wind bias
                    if(p.x > w) p.x = 0;
                    cx.strokeStyle = 'white'; cx.lineWidth = 1;
                    cx.beginPath(); cx.moveTo(p.x, p.y); cx.lineTo(p.x-5, p.y-5); cx.lineTo(p.x+5, p.y-5); cx.stroke();
                    cx.beginPath(); cx.moveTo(p.x, p.y); cx.lineTo(p.x, p.y+10); cx.stroke(); // Seed
                });
            } else if (mode === 'self') { // Explosion
                particles.forEach(p => {
                    p.x += p.vx; p.y += p.vy; p.vy += 0.5; // Gravity
                    cx.fillStyle = '#fde047'; cx.beginPath(); cx.arc(p.x, p.y, 4, 0, Math.PI*2); cx.fill();
                    if(p.y > h*0.8) { p.y = h*0.8; p.vx = 0; } // Land
                });
                // Pod
                cx.fillStyle = '#166534'; cx.beginPath(); cx.ellipse(w/2, h/2, 10, 40, 0, 0, Math.PI*2); cx.fill();
            } else { // Animal (Burr)
                const p = particles[0];
                p.x += 2; if(p.x > w) p.x = 0;
                p.y = h*0.75 + Math.sin(p.x*0.1)*5;
                cx.fillStyle = '#7f1d1d'; cx.beginPath(); cx.arc(p.x, p.y, 15, 0, Math.PI*2); cx.fill();
                // Spikes
                for(let i=0; i<8; i++) {
                    const ang = i * Math.PI/4;
                    cx.beginPath(); cx.moveTo(p.x, p.y); cx.lineTo(p.x+Math.cos(ang)*20, p.y+Math.sin(ang)*20); cx.stroke();
                }
                cx.fillStyle = 'white'; cx.font = '20px Arial'; cx.fillText('üê∫', p.x-10, p.y+5);
            }

            requestAnimationFrame(draw);
        }

        window.onload = () => {
            cvs = document.getElementById('dispCanvas'); cx = cvs.getContext('2d');
            const rs = () => { cvs.width = cvs.parentElement.clientWidth; cvs.height = cvs.parentElement.clientHeight; initParticles(); };
            window.addEventListener('resize', rs); rs();
            draw();
        }
    </script>

<script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
<script>
    function goBack() {
        console.log('goBack() –≤—ã–∑–≤–∞–Ω–∞');
        if (typeof bridge !== 'undefined' && bridge) {
            console.log('Bridge –Ω–∞–π–¥–µ–Ω, –≤—ã–∑—ã–≤–∞—é onBackClicked()');
            bridge.onBackClicked();
        } else {
            console.log('Bridge –Ω–µ –Ω–∞–π–¥–µ–Ω!');
        }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è QWebChannel
    document.addEventListener('DOMContentLoaded', function() {
        console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è QWebChannel...');

        if (typeof QWebChannel !== 'undefined' && typeof qt !== 'undefined') {
            try {
                new QWebChannel(qt.webChannelTransport, function(channel) {
                    window.bridge = channel.objects.bridge;
                    console.log('‚úÖ Bridge –ø–æ–¥–∫–ª—é—á–µ–Ω!');
                });
            } catch(e) {
                console.error('‚ùå QWebChannel –æ—à–∏–±–∫–∞:', e);
            }
        } else {
            console.warn('‚ö†Ô∏è QWebChannel –∏–ª–∏ qt –Ω–µ –Ω–∞–π–¥–µ–Ω');
        }
    });
</script>

</body>
</html>