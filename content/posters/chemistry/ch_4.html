<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–ª–µ–∫—É–ª–∞ –º–µ—Ç–∞–Ω–∞ (CH‚ÇÑ)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #141e30 0%, #243b55 100%);
            overflow: hidden;
            color: white;
        }

        .header {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            text-align: center;
        }

        .header h1 {
            font-size: 36px;
            font-weight: 800;
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            margin-bottom: 5px;
        }

        .header p {
            font-size: 15px;
            opacity: 0.9;
        }

        #canvas-container {
            width: 100vw;
            height: 100vh;
        }

        .info-panel {
            position: fixed;
            right: -420px;
            top: 50%;
            transform: translateY(-50%);
            width: 400px;
            max-height: 85vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px 0 0 20px;
            padding: 30px;
            box-shadow: -5px 0 30px rgba(0, 0, 0, 0.4);
            transition: right 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 500;
            overflow-y: auto;
            color: #333;
        }

        .info-panel.active {
            right: 0;
        }

        .info-panel .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #f44336;
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .info-panel .close-btn:hover {
            transform: scale(1.1);
        }

        .info-panel h2 {
            color: #141e30;
            font-size: 24px;
            margin-bottom: 15px;
            padding-right: 40px;
        }

        .info-panel .info-content {
            line-height: 1.7;
            font-size: 15px;
        }

        .info-section {
            margin-bottom: 18px;
            padding: 15px;
            background: rgba(36, 59, 85, 0.08);
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
        }

        .info-section strong {
            color: #141e30;
            display: block;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .controls p {
            font-size: 14px;
            opacity: 0.95;
            text-align: center;
        }

        .molecule-info {
            position: fixed;
            top: 140px;
            left: 30px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 300px;
        }

        .molecule-info h3 {
            font-size: 18px;
            margin-bottom: 12px;
            font-weight: 600;
            color: #4CAF50;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            font-size: 14px;
        }

        .info-row .label {
            opacity: 0.85;
        }

        .info-row .value {
            font-weight: 600;
        }

        .legend {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 280px;
        }

        .legend h3 {
            font-size: 16px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            font-size: 13px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .legend-item:hover {
            transform: translateX(5px);
        }

        .legend-sphere {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            margin-right: 12px;
            border: 2px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        .view-controls {
            position: fixed;
            top: 140px;
            right: 30px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .view-controls h3 {
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .view-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
        }

        .view-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateX(3px);
        }

        .view-btn.active {
            background: rgba(76, 175, 80, 0.5);
            border-color: #4CAF50;
        }
    </style>
</head>
<body>
<div class="header">
    <h1>üß™ –ú–æ–ª–µ–∫—É–ª–∞ –º–µ—Ç–∞–Ω–∞ (CH‚ÇÑ)</h1>
    <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è 3D –º–æ–¥–µ–ª—å - –¢–µ—Ç—Ä–∞—ç–¥—Ä–∏—á–µ—Å–∫–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è</p>
</div>

<div id="canvas-container"></div>

<div class="molecule-info">
    <h3>–ú–µ—Ç–∞–Ω (CH‚ÇÑ)</h3>
    <div class="info-row">
        <span class="label">–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞:</span>
        <span class="value">16.043 –≥/–º–æ–ª—å</span>
    </div>
    <div class="info-row">
        <span class="label">–£–≥–æ–ª —Å–≤—è–∑–∏:</span>
        <span class="value">109.5¬∞</span>
    </div>
    <div class="info-row">
        <span class="label">–î–ª–∏–Ω–∞ C-H —Å–≤—è–∑–∏:</span>
        <span class="value">109 –ø–º</span>
    </div>
    <div class="info-row">
        <span class="label">–¢–∏–ø —Å–≤—è–∑–∏:</span>
        <span class="value">–ö–æ–≤–∞–ª–µ–Ω—Ç–Ω–∞—è</span>
    </div>
    <div class="info-row">
        <span class="label">–ü–æ–ª—è—Ä–Ω–æ—Å—Ç—å:</span>
        <span class="value">–ù–µ–ø–æ–ª—è—Ä–Ω–∞—è</span>
    </div>
    <div class="info-row">
        <span class="label">–§–æ—Ä–º–∞:</span>
        <span class="value">–¢–µ—Ç—Ä–∞—ç–¥—Ä</span>
    </div>
    <div class="info-row">
        <span class="label">–ì–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏—è:</span>
        <span class="value">sp¬≥</span>
    </div>
</div>

<div class="view-controls">
    <h3>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:</h3>
    <button class="view-btn active" onclick="toggleTetrahedron()">–ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ—Ç—Ä–∞—ç–¥—Ä</button>
    <button class="view-btn" onclick="toggleOrbitals()">–û—Ä–±–∏—Ç–∞–ª–∏ sp¬≥</button>
    <button class="view-btn" onclick="toggleAngles()">–ü–æ–∫–∞–∑–∞—Ç—å —É–≥–ª—ã</button>
    <button class="view-btn" onclick="toggleElectronDensity()">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å</button>
</div>

<div class="info-panel" id="info-panel">
    <button class="close-btn" onclick="closeInfo()">√ó</button>
    <h2 id="info-title">–ú–æ–ª–µ–∫—É–ª–∞ –º–µ—Ç–∞–Ω–∞</h2>
    <div class="info-content" id="info-content">
        <p>–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∞—Ç–æ–º —É–≥–ª–µ—Ä–æ–¥–∞ –∏–ª–∏ –≤–æ–¥–æ—Ä–æ–¥–∞, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ.</p>
    </div>
</div>

<div class="controls">
    <p>üñ±Ô∏è –í—Ä–∞—â–µ–Ω–∏–µ: –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ | üîç –ú–∞—Å—à—Ç–∞–±: –∫–æ–ª–µ—Å–æ –º—ã—à–∏ | –ü—Ä–æ–±–µ–ª: –ø–∞—É–∑–∞</p>
</div>

<div class="legend">
    <h3>–ê—Ç–æ–º—ã:</h3>
    <div class="legend-item" onclick="focusPart('carbon')">
        <div class="legend-sphere" style="background: radial-gradient(circle at 30% 30%, #555555, #222222);"></div>
        <span>–£–≥–ª–µ—Ä–æ–¥ (C)</span>
    </div>
    <div class="legend-item" onclick="focusPart('hydrogen')">
        <div class="legend-sphere" style="background: radial-gradient(circle at 30% 30%, #e8f4f8, #b8d4e8);"></div>
        <span>–í–æ–¥–æ—Ä–æ–¥ (H)</span>
    </div>
</div>

<script>
    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—Ç–æ–º–∞—Ö
    const atomInfo = {
        carbon: {
            title: "–ê—Ç–æ–º —É–≥–ª–µ—Ä–æ–¥–∞ (C)",
            content: `
                    <div class="info-section">
                        <strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</strong>
                        <p>‚Ä¢ –ê—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä: 6<br>
                        ‚Ä¢ –ê—Ç–æ–º–Ω–∞—è –º–∞—Å—Å–∞: 12.011 –∞.–µ.–º.<br>
                        ‚Ä¢ –≠–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2.55<br>
                        ‚Ä¢ –í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å: 4<br>
                        ‚Ä¢ –ö–æ–≤–∞–ª–µ–Ω—Ç–Ω—ã–π —Ä–∞–¥–∏—É—Å: 77 –ø–º</p>
                    </div>
                    <div class="info-section">
                        <strong>–†–æ–ª—å –≤ –º–æ–ª–µ–∫—É–ª–µ:</strong>
                        <p>–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞—Ç–æ–º –º–æ–ª–µ–∫—É–ª—ã –º–µ—Ç–∞–Ω–∞. –û–±—Ä–∞–∑—É–µ—Ç —á–µ—Ç—ã—Ä–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–æ–≤–∞–ª–µ–Ω—Ç–Ω—ã–µ œÉ-—Å–≤—è–∑–∏ —Å –∞—Ç–æ–º–∞–º–∏ –≤–æ–¥–æ—Ä–æ–¥–∞.</p>
                    </div>
                    <div class="info-section">
                        <strong>–ì–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏—è:</strong>
                        <p>sp¬≥-–≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏—è. –ß–µ—Ç—ã—Ä–µ sp¬≥-–≥–∏–±—Ä–∏–¥–Ω—ã–µ –æ—Ä–±–∏—Ç–∞–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –∫ –≤–µ—Ä—à–∏–Ω–∞–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–µ—Ç—Ä–∞—ç–¥—Ä–∞ –ø–æ–¥ —É–≥–ª–æ–º 109.5¬∞.</p>
                    </div>
                    <div class="info-section">
                        <strong>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</strong>
                        <p>–û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: 1s¬≤ 2s¬≤ 2p¬≤<br>
                        –í–æ–∑–±—É–∂–¥—ë–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: 1s¬≤ 2s¬π 2p¬≥<br>
                        –ü—Ä–∏ –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏–∏: —á–µ—Ç—ã—Ä–µ sp¬≥-–æ—Ä–±–∏—Ç–∞–ª–∏</p>
                    </div>
                `
        },
        hydrogen: {
            title: "–ê—Ç–æ–º –≤–æ–¥–æ—Ä–æ–¥–∞ (H)",
            content: `
                    <div class="info-section">
                        <strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</strong>
                        <p>‚Ä¢ –ê—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä: 1<br>
                        ‚Ä¢ –ê—Ç–æ–º–Ω–∞—è –º–∞—Å—Å–∞: 1.008 –∞.–µ.–º.<br>
                        ‚Ä¢ –≠–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2.20<br>
                        ‚Ä¢ –í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å: 1<br>
                        ‚Ä¢ –ö–æ–≤–∞–ª–µ–Ω—Ç–Ω—ã–π —Ä–∞–¥–∏—É—Å: 31 –ø–º</p>
                    </div>
                    <div class="info-section">
                        <strong>–†–æ–ª—å –≤ –º–æ–ª–µ–∫—É–ª–µ:</strong>
                        <p>–û–±—Ä–∞–∑—É–µ—Ç –∫–æ–≤–∞–ª–µ–Ω—Ç–Ω—É—é œÉ-—Å–≤—è–∑—å —Å —É–≥–ª–µ—Ä–æ–¥–æ–º. –í –º–æ–ª–µ–∫—É–ª–µ –º–µ—Ç–∞–Ω–∞ —á–µ—Ç—ã—Ä–µ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã—Ö –∞—Ç–æ–º–∞ –≤–æ–¥–æ—Ä–æ–¥–∞.</p>
                    </div>
                    <div class="info-section">
                        <strong>–¢–∏–ø —Å–≤—è–∑–∏ C-H:</strong>
                        <p>–°–ª–∞–±–æ–ø–æ–ª—è—Ä–Ω–∞—è –∫–æ–≤–∞–ª–µ–Ω—Ç–Ω–∞—è —Å–≤—è–∑—å. –†–∞–∑–Ω–∏—Ü–∞ —ç–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π C –∏ H –Ω–µ–±–æ–ª—å—à–∞—è (0.35), –ø–æ—ç—Ç–æ–º—É –º–æ–ª–µ–∫—É–ª–∞ –≤ —Ü–µ–ª–æ–º –Ω–µ–ø–æ–ª—è—Ä–Ω–∞.</p>
                    </div>
                    <div class="info-section">
                        <strong>–ü–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ:</strong>
                        <p>–ß–µ—Ç—ã—Ä–µ –∞—Ç–æ–º–∞ –≤–æ–¥–æ—Ä–æ–¥–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ –Ω–∞ –≤–µ—Ä—à–∏–Ω–∞—Ö –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–µ—Ç—Ä–∞—ç–¥—Ä–∞ —Å —É–≥–ª–µ—Ä–æ–¥–æ–º –≤ —Ü–µ–Ω—Ç—Ä–µ.</p>
                    </div>
                `
        },
        molecule: {
            title: "–ú–æ–ª–µ–∫—É–ª–∞ –º–µ—Ç–∞–Ω–∞ (CH‚ÇÑ)",
            content: `
                    <div class="info-section">
                        <strong>–ì–µ–æ–º–µ—Ç—Ä–∏—è –º–æ–ª–µ–∫—É–ª—ã:</strong>
                        <p>–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–µ—Ç—Ä–∞—ç–¥—Ä–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º–∞. –í—Å–µ —á–µ—Ç—ã—Ä–µ —Å–≤—è–∑–∏ C-H –∏–¥–µ–Ω—Ç–∏—á–Ω—ã –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –∫ –≤–µ—Ä—à–∏–Ω–∞–º —Ç–µ—Ç—Ä–∞—ç–¥—Ä–∞. –£–≥–æ–ª H-C-H = 109.5¬∞ (—Ç–µ—Ç—Ä–∞—ç–¥—Ä–∏—á–µ—Å–∫–∏–π —É–≥–æ–ª).</p>
                    </div>
                    <div class="info-section">
                        <strong>–ü–æ–ª—è—Ä–Ω–æ—Å—Ç—å:</strong>
                        <p>–ú–æ–ª–µ–∫—É–ª–∞ –Ω–µ–ø–æ–ª—è—Ä–Ω–∞. –•–æ—Ç—è —Å–≤—è–∑–∏ C-H —Å–ª–∞–±–æ–ø–æ–ª—è—Ä–Ω—ã, —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∞—Ç–æ–º–æ–≤ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω—É–ª–µ–≤–æ–º—É –¥–∏–ø–æ–ª—å–Ω–æ–º—É –º–æ–º–µ–Ω—Ç—É.</p>
                    </div>
                    <div class="info-section">
                        <strong>–¢–∏–ø –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏–∏:</strong>
                        <p>sp¬≥-–≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏—è —É–≥–ª–µ—Ä–æ–¥–∞. –û–¥–∏–Ω 2s-—ç–ª–µ–∫—Ç—Ä–æ–Ω –∏ —Ç—Ä–∏ 2p-—ç–ª–µ–∫—Ç—Ä–æ–Ω–∞ –æ–±—Ä–∞–∑—É—é—Ç —á–µ—Ç—ã—Ä–µ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–µ sp¬≥-–æ—Ä–±–∏—Ç–∞–ª–∏.</p>
                    </div>
                    <div class="info-section">
                        <strong>–•–∏–º–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:</strong>
                        <p>‚Ä¢ –ì–æ—Ä–µ–Ω–∏–µ: CH‚ÇÑ + 2O‚ÇÇ ‚Üí CO‚ÇÇ + 2H‚ÇÇO<br>
                        ‚Ä¢ –ó–∞–º–µ—â–µ–Ω–∏–µ: CH‚ÇÑ + Cl‚ÇÇ ‚Üí CH‚ÇÉCl + HCl<br>
                        ‚Ä¢ –•–∏–º–∏—á–µ—Å–∫–∏ —Å—Ç–∞–±–∏–ª–µ–Ω –ø—Ä–∏ –æ–±—ã—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö<br>
                        ‚Ä¢ –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏—Ä–æ–¥–Ω–æ–≥–æ –≥–∞–∑–∞</p>
                    </div>
                    <div class="info-section">
                        <strong>–§–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:</strong>
                        <p>‚Ä¢ –ë–µ—Å—Ü–≤–µ—Ç–Ω—ã–π –≥–∞–∑ –±–µ–∑ –∑–∞–ø–∞—Ö–∞<br>
                        ‚Ä¢ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∏–ø–µ–Ω–∏—è: -161.5¬∞C<br>
                        ‚Ä¢ –ü–ª–æ—Ç–Ω–æ—Å—Ç—å: 0.656 –∫–≥/–º¬≥ (–ø—Ä–∏ –Ω.—É.)<br>
                        ‚Ä¢ –õ–µ–≥—á–µ –≤–æ–∑–¥—É—Ö–∞<br>
                        ‚Ä¢ –ü–ª–æ—Ö–æ —Ä–∞—Å—Ç–≤–æ—Ä–∏–º –≤ –≤–æ–¥–µ</p>
                    </div>
                    <div class="info-section">
                        <strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:</strong>
                        <p>‚Ä¢ –¢–æ–ø–ª–∏–≤–æ (–ø—Ä–∏—Ä–æ–¥–Ω—ã–π –≥–∞–∑)<br>
                        ‚Ä¢ –°—ã—Ä—å—ë –¥–ª—è —Ö–∏–º–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏<br>
                        ‚Ä¢ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –≤–æ–¥–æ—Ä–æ–¥–∞<br>
                        ‚Ä¢ –ü–æ–ª—É—á–µ–Ω–∏–µ —É–≥–ª–µ—Ä–æ–¥–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</p>
                    </div>
                `
        }
    };

    // Three.js
    let scene, camera, renderer;
    let moleculeGroup;
    let atoms = {};
    let bonds = [];
    let tetrahedron = null;
    let orbitals = [];
    let angleIndicators = [];
    let electronDensity = null;
    let raycaster, mouse;
    let selectedPart = null;
    let isDragging = false;
    let previousMousePosition = {x: 0, y: 0};
    let animationPaused = false;
    let showTetrahedron = true;
    let showOrbitals = false;
    let showAngles = false;
    let showDensity = false;

    function init() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x141e30);

        camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 7);

        const container = document.getElementById('canvas-container');
        renderer = new THREE.WebGLRenderer({antialias: true});
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);

        // –û—Å–≤–µ—â–µ–Ω–∏–µ
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);

        const light1 = new THREE.DirectionalLight(0xffffff, 0.8);
        light1.position.set(5, 5, 5);
        scene.add(light1);

        const light2 = new THREE.DirectionalLight(0xffffff, 0.5);
        light2.position.set(-5, -3, -5);
        scene.add(light2);

        const light3 = new THREE.PointLight(0x4CAF50, 0.6, 20);
        light3.position.set(0, 3, 3);
        scene.add(light3);

        moleculeGroup = new THREE.Group();
        scene.add(moleculeGroup);

        createMethaneMolecule();

        raycaster = new THREE.Raycaster();
        mouse = new THREE.Vector2();

        window.addEventListener('resize', onWindowResize);
        renderer.domElement.addEventListener('click', onMouseClick);
        renderer.domElement.addEventListener('mousemove', onMouseMove);
        renderer.domElement.addEventListener('mousedown', onMouseDown);
        renderer.domElement.addEventListener('mouseup', onMouseUp);
        renderer.domElement.addEventListener('wheel', onWheel);
        window.addEventListener('keydown', onKeyDown);

        animate();
    }

    function createMethaneMolecule() {
        // –ê–¢–û–ú –£–ì–õ–ï–†–û–î–ê (—Ü–µ–Ω—Ç—Ä)
        const carbonGeom = new THREE.SphereGeometry(0.5, 32, 32);
        const carbonMat = new THREE.MeshPhongMaterial({
            color: 0x444444,
            emissive: 0x222222,
            emissiveIntensity: 0.3,
            shininess: 100,
            specular: 0xffffff
        });
        const carbon = new THREE.Mesh(carbonGeom, carbonMat);
        carbon.position.set(0, 0, 0);
        carbon.userData = {type: 'carbon'};
        moleculeGroup.add(carbon);
        atoms.carbon = carbon;

        // –ê–¢–û–ú–´ –í–û–î–û–†–û–î–ê (—Ç–µ—Ç—Ä–∞—ç–¥—Ä–∏—á–µ—Å–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏)
        const bondLength = 2.0;

        // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–µ—Ä—à–∏–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–µ—Ç—Ä–∞—ç–¥—Ä–∞
        const tetraCoords = [
            [1, 1, 1],
            [-1, -1, 1],
            [-1, 1, -1],
            [1, -1, -1]
        ];

        const hydrogenGeom = new THREE.SphereGeometry(0.3, 32, 32);
        const hydrogenMat = new THREE.MeshPhongMaterial({
            color: 0xe8f4f8,
            emissive: 0xb8d4e8,
            emissiveIntensity: 0.2,
            shininess: 100,
            specular: 0xffffff
        });

        tetraCoords.forEach((coord, i) => {
            const hydrogen = new THREE.Mesh(hydrogenGeom.clone(), hydrogenMat.clone());
            const normalized = new THREE.Vector3(coord[0], coord[1], coord[2]).normalize();
            hydrogen.position.copy(normalized.multiplyScalar(bondLength));
            hydrogen.userData = {type: 'hydrogen', id: i + 1};
            moleculeGroup.add(hydrogen);
            atoms[`hydrogen${i + 1}`] = hydrogen;

            // –°–æ–∑–¥–∞—ë–º —Å–≤—è–∑—å C-H
            createBond(carbon.position, hydrogen.position);
        });

        // –¢–ï–¢–†–ê–≠–î–† (–∫–∞—Ä–∫–∞—Å)
        createTetrahedronFrame();

        // –û–†–ë–ò–¢–ê–õ–ò sp¬≥
        createOrbitals();

        // –ò–ù–î–ò–ö–ê–¢–û–†–´ –£–ì–õ–û–í
        createAngleIndicators();

        // –≠–õ–ï–ö–¢–†–û–ù–ù–ê–Ø –ü–õ–û–¢–ù–û–°–¢–¨
        createElectronDensity();
    }

    function createBond(pos1, pos2) {
        const direction = new THREE.Vector3().subVectors(pos2, pos1);
        const length = direction.length();
        const bondGeom = new THREE.CylinderGeometry(0.08, 0.08, length, 16);
        const bondMat = new THREE.MeshPhongMaterial({
            color: 0xcccccc,
            shininess: 50
        });
        const bond = new THREE.Mesh(bondGeom, bondMat);

        bond.position.copy(pos1).add(direction.multiplyScalar(0.5));
        bond.lookAt(pos2);
        bond.rotateX(Math.PI / 2);

        moleculeGroup.add(bond);
        bonds.push(bond);
    }

    function createTetrahedronFrame() {
        const bondLength = 2.0;
        const coords = [
            [1, 1, 1],
            [-1, -1, 1],
            [-1, 1, -1],
            [1, -1, -1]
        ];

        const points = coords.map(c =>
                new THREE.Vector3(c[0], c[1], c[2]).normalize().multiplyScalar(bondLength)
        );

        // –†—ë–±—Ä–∞ —Ç–µ—Ç—Ä–∞—ç–¥—Ä–∞
        const edges = [
            [0, 1], [0, 2], [0, 3],
            [1, 2], [1, 3], [2, 3]
        ];

        const material = new THREE.LineBasicMaterial({
            color: 0x4CAF50,
            transparent: true,
            opacity: 0.4,
            linewidth: 2
        });

        const tetraGroup = new THREE.Group();

        edges.forEach(edge => {
            const geometry = new THREE.BufferGeometry().setFromPoints([
                points[edge[0]],
                points[edge[1]]
            ]);
            const line = new THREE.Line(geometry, material);
            tetraGroup.add(line);
        });

        tetraGroup.visible = showTetrahedron;
        moleculeGroup.add(tetraGroup);
        tetrahedron = tetraGroup;
    }

    function createOrbitals() {
        // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ç—ã—Ä—ë—Ö sp¬≥-–æ—Ä–±–∏—Ç–∞–ª–µ–π
        const bondLength = 2.0;
        const coords = [
            [1, 1, 1],
            [-1, -1, 1],
            [-1, 1, -1],
            [1, -1, -1]
        ];

        coords.forEach(coord => {
            const direction = new THREE.Vector3(coord[0], coord[1], coord[2]).normalize();

            // –§–æ—Ä–º–∞ –æ—Ä–±–∏—Ç–∞–ª–∏ - –≤—ã—Ç—è–Ω—É—Ç—ã–π —ç–ª–ª–∏–ø—Å–æ–∏–¥
            const orbitalGeom = new THREE.SphereGeometry(0.3, 24, 24);
            const orbitalMat = new THREE.MeshBasicMaterial({
                color: 0xffaa00,
                transparent: true,
                opacity: 0.25,
                side: THREE.DoubleSide
            });
            const orbital = new THREE.Mesh(orbitalGeom, orbitalMat);
            orbital.scale.set(1, 1, 2.5);
            orbital.position.copy(direction.multiplyScalar(1.0));
            orbital.lookAt(direction.multiplyScalar(3));
            orbital.visible = showOrbitals;
            moleculeGroup.add(orbital);
            orbitals.push(orbital);
        });
    }

    function createAngleIndicators() {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≥–æ–ª 109.5¬∞ –º–µ–∂–¥—É —Å–≤—è–∑—è–º–∏
        const angle = 109.5 * Math.PI / 180;

        const arcMaterial = new THREE.LineBasicMaterial({
            color: 0xffff00,
            transparent: true,
            opacity: 0.6,
            linewidth: 2
        });

        const curve = new THREE.EllipseCurve(
                0, 0,
                0.8, 0.8,
                0, angle,
                false,
                0
        );

        const points = curve.getPoints(30);
        const geometry = new THREE.BufferGeometry().setFromPoints(points);
        const arc = new THREE.Line(geometry, arcMaterial);
        arc.visible = showAngles;
        moleculeGroup.add(arc);
        angleIndicators.push(arc);
    }

    function createElectronDensity() {
        // –û–±—â–µ–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–µ –æ–±–ª–∞–∫–æ –º–æ–ª–µ–∫—É–ª—ã
        const densityGeom = new THREE.SphereGeometry(2.3, 32, 32);
        const densityMat = new THREE.MeshBasicMaterial({
            color: 0x00ffff,
            transparent: true,
            opacity: 0.1,
            side: THREE.BackSide
        });
        const density = new THREE.Mesh(densityGeom, densityMat);
        density.visible = showDensity;
        moleculeGroup.add(density);
        electronDensity = density;
    }

    function toggleTetrahedron() {
        showTetrahedron = !showTetrahedron;
        if (tetrahedron) tetrahedron.visible = showTetrahedron;
        updateButton(0, showTetrahedron);
    }

    function toggleOrbitals() {
        showOrbitals = !showOrbitals;
        orbitals.forEach(orbital => orbital.visible = showOrbitals);
        updateButton(1, showOrbitals);
    }

    function toggleAngles() {
        showAngles = !showAngles;
        angleIndicators.forEach(indicator => indicator.visible = showAngles);
        updateButton(2, showAngles);
    }

    function toggleElectronDensity() {
        showDensity = !showDensity;
        if (electronDensity) electronDensity.visible = showDensity;
        updateButton(3, showDensity);
    }

    function updateButton(index, active) {
        const buttons = document.querySelectorAll('.view-btn');
        if (buttons[index]) {
            buttons[index].classList.toggle('active', active);
        }
    }

    function onMouseDown(e) {
        isDragging = true;
        previousMousePosition = {x: e.clientX, y: e.clientY};
    }

    function onMouseUp() {
        isDragging = false;
    }

    function onMouseMove(e) {
        mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;

        if (isDragging) {
            const deltaX = e.clientX - previousMousePosition.x;
            const deltaY = e.clientY - previousMousePosition.y;
            moleculeGroup.rotation.y += deltaX * 0.005;
            moleculeGroup.rotation.x += deltaY * 0.005;
            previousMousePosition = {x: e.clientX, y: e.clientY};
        }

        raycaster.setFromCamera(mouse, camera);
        const atomArray = [atoms.carbon, atoms.hydrogen1, atoms.hydrogen2, atoms.hydrogen3, atoms.hydrogen4];
        const intersects = raycaster.intersectObjects(atomArray);
        document.body.style.cursor = intersects.length > 0 ? 'pointer' : 'default';
    }

    function onMouseClick(e) {
        mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);
        const atomArray = [atoms.carbon, atoms.hydrogen1, atoms.hydrogen2, atoms.hydrogen3, atoms.hydrogen4];
        const intersects = raycaster.intersectObjects(atomArray);

        if (intersects.length > 0) {
            const atom = intersects[0].object;
            const type = atom.userData.type;
            showInfo(type);
            highlightPart(atom);
        } else {
            showInfo('molecule');
        }
    }

    function onWheel(e) {
        e.preventDefault();
        camera.position.z += e.deltaY * 0.005;
        camera.position.z = Math.max(3, Math.min(12, camera.position.z));
    }

    function onKeyDown(e) {
        if (e.code === 'Space') {
            e.preventDefault();
            animationPaused = !animationPaused;
        }
    }

    function showInfo(type) {
        const info = atomInfo[type];
        if (info) {
            document.getElementById('info-title').textContent = info.title;
            document.getElementById('info-content').innerHTML = info.content;
            document.getElementById('info-panel').classList.add('active');
        }
    }

    function closeInfo() {
        document.getElementById('info-panel').classList.remove('active');
        if (selectedPart) {
            const originalColor = selectedPart.userData.type === 'carbon' ? 0x222222 : 0xb8d4e8;
            selectedPart.material.emissive.setHex(originalColor);
            selectedPart.material.emissiveIntensity = selectedPart.userData.type === 'carbon' ? 0.3 : 0.2;
            selectedPart = null;
        }
    }

    function highlightPart(atom) {
        if (selectedPart) {
            const originalColor = selectedPart.userData.type === 'carbon' ? 0x222222 : 0xb8d4e8;
            selectedPart.material.emissive.setHex(originalColor);
            selectedPart.material.emissiveIntensity = selectedPart.userData.type === 'carbon' ? 0.3 : 0.2;
        }
        atom.material.emissive.setHex(0xffffff);
        atom.material.emissiveIntensity = 0.7;
        selectedPart = atom;
    }

    function focusPart(type) {
        if (type === 'carbon') {
            showInfo('carbon');
            highlightPart(atoms.carbon);
        } else if (type === 'hydrogen') {
            showInfo('hydrogen');
            highlightPart(atoms.hydrogen1);
        }
    }

    function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
        requestAnimationFrame(animate);

        if (!animationPaused) {
            moleculeGroup.rotation.y += 0.003;
        }

        renderer.render(scene, camera);
    }

    window.addEventListener('load', init);
</script>
</body>
</html>