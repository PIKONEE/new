<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–ª–µ–∫—É–ª–∞ –≤–æ–¥—ã (H‚ÇÇO)</title>
    <script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 50%, #415a77 100%);
            overflow: hidden;
            color: white;
        }



        .back-button:hover {
            transform: translateX(-5px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .header {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 800;
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        #canvas-container {
            width: 100vw;
            height: 100vh;
        }

        .info-panel {
            position: fixed;
            right: -420px;
            top: 50%;
            transform: translateY(-50%);
            width: 400px;
            max-height: 85vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px 0 0 20px;
            padding: 30px;
            box-shadow: -5px 0 30px rgba(0, 0, 0, 0.4);
            transition: right 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 500;
            overflow-y: auto;
            color: #333;
        }

        .info-panel.active {
            right: 0;
        }

        .info-panel .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #f44336;
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .info-panel .close-btn:hover {
            transform: scale(1.1);
        }

        .info-panel h2 {
            color: #0d1b2a;
            font-size: 24px;
            margin-bottom: 15px;
            padding-right: 40px;
        }

        .info-panel .info-content {
            line-height: 1.7;
            font-size: 15px;
        }

        .info-section {
            margin-bottom: 18px;
            padding: 15px;
            background: rgba(65, 90, 119, 0.08);
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .info-section strong {
            color: #0d1b2a;
            display: block;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .controls p {
            font-size: 14px;
            opacity: 0.95;
            text-align: center;
        }

        .molecule-info {
            position: fixed;
            top: 120px;
            left: 30px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 280px;
        }

        .molecule-info h3 {
            font-size: 18px;
            margin-bottom: 12px;
            font-weight: 600;
            color: #3498db;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            font-size: 14px;
        }

        .info-row .label {
            opacity: 0.85;
        }

        .info-row .value {
            font-weight: 600;
        }

        .legend {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 280px;
        }

        .legend h3 {
            font-size: 16px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            font-size: 13px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .legend-item:hover {
            transform: translateX(5px);
        }

        .legend-sphere {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            margin-right: 12px;
            border: 2px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        .view-controls {
            position: fixed;
            top: 120px;
            right: 30px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .view-controls h3 {
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .view-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
        }

        .view-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateX(3px);
        }

        .view-btn.active {
            background: rgba(52, 152, 219, 0.5);
            border-color: #3498db;
        }
    </style>
</head>
<body>


<div class="header">
    <h1>üíß –ú–æ–ª–µ–∫—É–ª–∞ –≤–æ–¥—ã (H‚ÇÇO)</h1>
    <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è 3D –º–æ–¥–µ–ª—å</p>
</div>

<div id="canvas-container"></div>

<div class="molecule-info">
    <h3>–í–æ–¥–∞ (H‚ÇÇO)</h3>
    <div class="info-row">
        <span class="label">–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞:</span>
        <span class="value">18.015 –≥/–º–æ–ª—å</span>
    </div>
    <div class="info-row">
        <span class="label">–£–≥–æ–ª —Å–≤—è–∑–∏:</span>
        <span class="value">104.5¬∞</span>
    </div>
    <div class="info-row">
        <span class="label">–î–ª–∏–Ω–∞ O-H —Å–≤—è–∑–∏:</span>
        <span class="value">95.84 –ø–º</span>
    </div>
    <div class="info-row">
        <span class="label">–¢–∏–ø —Å–≤—è–∑–∏:</span>
        <span class="value">–ö–æ–≤–∞–ª–µ–Ω—Ç–Ω–∞—è</span>
    </div>
    <div class="info-row">
        <span class="label">–ü–æ–ª—è—Ä–Ω–æ—Å—Ç—å:</span>
        <span class="value">–ü–æ–ª—è—Ä–Ω–∞—è</span>
    </div>
    <div class="info-row">
        <span class="label">–§–æ—Ä–º–∞ –º–æ–ª–µ–∫—É–ª—ã:</span>
        <span class="value">–£–≥–ª–æ–≤–∞—è</span>
    </div>
</div>

<div class="view-controls">
    <h3>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:</h3>
    <button class="view-btn active" onclick="toggleDipole()">–ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–ø–æ–ª—å</button>
    <button class="view-btn" onclick="toggleElectronCloud()">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –æ–±–ª–∞–∫–∞</button>
    <button class="view-btn" onclick="toggleCharges()">–ß–∞—Å—Ç–∏—á–Ω—ã–µ –∑–∞—Ä—è–¥—ã</button>
    <button class="view-btn" onclick="toggleAngles()">–ü–æ–∫–∞–∑–∞—Ç—å —É–≥–ª—ã</button>
</div>

<div class="info-panel" id="info-panel">
    <button class="close-btn" onclick="closeInfo()">√ó</button>
    <h2 id="info-title">–ú–æ–ª–µ–∫—É–ª–∞ –≤–æ–¥—ã</h2>
    <div class="info-content" id="info-content">
        <p>–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∞—Ç–æ–º –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –∏–ª–∏ –≤–æ–¥–æ—Ä–æ–¥–∞, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ.</p>
    </div>
</div>

<div class="controls">
    <p>üñ±Ô∏è –í—Ä–∞—â–µ–Ω–∏–µ: –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ | üîç –ú–∞—Å—à—Ç–∞–±: –∫–æ–ª–µ—Å–æ –º—ã—à–∏ | –ü—Ä–æ–±–µ–ª: –ø–∞—É–∑–∞</p>
</div>

<div class="legend">
    <h3>–ê—Ç–æ–º—ã:</h3>
    <div class="legend-item" onclick="focusPart('oxygen')">
        <div class="legend-sphere" style="background: radial-gradient(circle at 30% 30%, #ff4444, #cc0000);"></div>
        <span>–ö–∏—Å–ª–æ—Ä–æ–¥ (O)</span>
    </div>
    <div class="legend-item" onclick="focusPart('hydrogen')">
        <div class="legend-sphere" style="background: radial-gradient(circle at 30% 30%, #e8f4f8, #b8d4e8);"></div>
        <span>–í–æ–¥–æ—Ä–æ–¥ (H)</span>
    </div>
</div>

<script>
    // QWebChannel Bridge
    function goBack() {
        if (typeof bridge !== 'undefined' && bridge) {
            bridge.onBackClicked();
        }
    }

    if (typeof QWebChannel !== 'undefined' && typeof qt !== 'undefined') {
        try {
            new QWebChannel(qt.webChannelTransport, function (channel) {
                window.bridge = channel.objects.bridge;
            });
        } catch (e) {
        }
    }

    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—Ç–æ–º–∞—Ö
    const atomInfo = {
        oxygen: {
            title: "–ê—Ç–æ–º –∫–∏—Å–ª–æ—Ä–æ–¥–∞ (O)",
            content: `
                    <div class="info-section">
                        <strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</strong>
                        <p>‚Ä¢ –ê—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä: 8<br>
                        ‚Ä¢ –ê—Ç–æ–º–Ω–∞—è –º–∞—Å—Å–∞: 15.999 –∞.–µ.–º.<br>
                        ‚Ä¢ –≠–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 3.44 (–ø–æ –ü–æ–ª–∏–Ω–≥—É)<br>
                        ‚Ä¢ –í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å: 2<br>
                        ‚Ä¢ –ö–æ–≤–∞–ª–µ–Ω—Ç–Ω—ã–π —Ä–∞–¥–∏—É—Å: 66 –ø–º</p>
                    </div>
                    <div class="info-section">
                        <strong>–†–æ–ª—å –≤ –º–æ–ª–µ–∫—É–ª–µ:</strong>
                        <p>–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞—Ç–æ–º –º–æ–ª–µ–∫—É–ª—ã –≤–æ–¥—ã. –û–±—Ä–∞–∑—É–µ—Ç –¥–≤–µ –∫–æ–≤–∞–ª–µ–Ω—Ç–Ω—ã–µ —Å–≤—è–∑–∏ —Å –∞—Ç–æ–º–∞–º–∏ –≤–æ–¥–æ—Ä–æ–¥–∞.</p>
                    </div>
                    <div class="info-section">
                        <strong>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</strong>
                        <p>1s¬≤ 2s¬≤ 2p‚Å¥<br>
                        –ù–∞ –≤–Ω–µ—à–Ω–µ–º —É—Ä–æ–≤–Ω–µ 6 —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–≤: 2 –Ω–µ–ø–æ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–∞—Ä—ã –∏ 2 —Å–≤—è–∑—ã–≤–∞—é—â–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω—ã.</p>
                    </div>
                    <div class="info-section">
                        <strong>–ß–∞—Å—Ç–∏—á–Ω—ã–π –∑–∞—Ä—è–¥:</strong>
                        <p>Œ¥‚Åª (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π). –ö–∏—Å–ª–æ—Ä–æ–¥ –±–æ–ª–µ–µ —ç–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω, —á–µ–º –≤–æ–¥–æ—Ä–æ–¥, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç —ç–ª–µ–∫—Ç—Ä–æ–Ω—ã —Å–≤—è–∑–∏ –∫ —Å–µ–±–µ.</p>
                    </div>
                `
        },
        hydrogen: {
            title: "–ê—Ç–æ–º –≤–æ–¥–æ—Ä–æ–¥–∞ (H)",
            content: `
                    <div class="info-section">
                        <strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</strong>
                        <p>‚Ä¢ –ê—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä: 1<br>
                        ‚Ä¢ –ê—Ç–æ–º–Ω–∞—è –º–∞—Å—Å–∞: 1.008 –∞.–µ.–º.<br>
                        ‚Ä¢ –≠–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2.20 (–ø–æ –ü–æ–ª–∏–Ω–≥—É)<br>
                        ‚Ä¢ –í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å: 1<br>
                        ‚Ä¢ –ö–æ–≤–∞–ª–µ–Ω—Ç–Ω—ã–π —Ä–∞–¥–∏—É—Å: 31 –ø–º</p>
                    </div>
                    <div class="info-section">
                        <strong>–†–æ–ª—å –≤ –º–æ–ª–µ–∫—É–ª–µ:</strong>
                        <p>–û–±—Ä–∞–∑—É–µ—Ç –ø–æ–ª—è—Ä–Ω—É—é –∫–æ–≤–∞–ª–µ–Ω—Ç–Ω—É—é —Å–≤—è–∑—å —Å –∫–∏—Å–ª–æ—Ä–æ–¥–æ–º. –í –º–æ–ª–µ–∫—É–ª–µ –≤–æ–¥—ã –¥–≤–∞ –∞—Ç–æ–º–∞ –≤–æ–¥–æ—Ä–æ–¥–∞.</p>
                    </div>
                    <div class="info-section">
                        <strong>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</strong>
                        <p>1s¬π (–æ–¥–∏–Ω —ç–ª–µ–∫—Ç—Ä–æ–Ω)<br>
                        –ü—Ä–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ —Å–≤—è–∑–∏ –¥–µ–ª–∏—Ç —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é –ø–∞—Ä—É —Å –∫–∏—Å–ª–æ—Ä–æ–¥–æ–º.</p>
                    </div>
                    <div class="info-section">
                        <strong>–ß–∞—Å—Ç–∏—á–Ω—ã–π –∑–∞—Ä—è–¥:</strong>
                        <p>Œ¥‚Å∫ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π). –≠–ª–µ–∫—Ç—Ä–æ–Ω—ã —Å–≤—è–∑–∏ —Å–º–µ—â–µ–Ω—ã –∫ –±–æ–ª–µ–µ —ç–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º—É –∫–∏—Å–ª–æ—Ä–æ–¥—É.</p>
                    </div>
                    <div class="info-section">
                        <strong>–í–æ–¥–æ—Ä–æ–¥–Ω—ã–µ —Å–≤—è–∑–∏:</strong>
                        <p>–ê—Ç–æ–º—ã –≤–æ–¥–æ—Ä–æ–¥–∞ –º–æ–≥—É—Ç –æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –≤–æ–¥–æ—Ä–æ–¥–Ω—ã–µ —Å–≤—è–∑–∏ —Å –∞—Ç–æ–º–∞–º–∏ –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –¥—Ä—É–≥–∏—Ö –º–æ–ª–µ–∫—É–ª –≤–æ–¥—ã, —á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –≤–æ–¥—ã.</p>
                    </div>
                `
        },
        molecule: {
            title: "–ú–æ–ª–µ–∫—É–ª–∞ –≤–æ–¥—ã (H‚ÇÇO)",
            content: `
                    <div class="info-section">
                        <strong>–ì–µ–æ–º–µ—Ç—Ä–∏—è –º–æ–ª–µ–∫—É–ª—ã:</strong>
                        <p>–£–≥–ª–æ–≤–∞—è (V-–æ–±—Ä–∞–∑–Ω–∞—è) —Ñ–æ—Ä–º–∞. –£–≥–æ–ª –º–µ–∂–¥—É —Å–≤—è–∑—è–º–∏ O-H —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 104.5¬∞ (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ 109.5¬∞ –¥–ª—è —Ç–µ—Ç—Ä–∞—ç–¥—Ä–∞, –Ω–æ —Å–∂–∞—Ç –∏–∑-–∑–∞ –Ω–µ–ø–æ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø–∞—Ä —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–≤).</p>
                    </div>
                    <div class="info-section">
                        <strong>–ü–æ–ª—è—Ä–Ω–æ—Å—Ç—å:</strong>
                        <p>–ú–æ–ª–µ–∫—É–ª–∞ –≤–æ–¥—ã –ø–æ–ª—è—Ä–Ω–∞. –ê—Ç–æ–º –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –∏–º–µ–µ—Ç —á–∞—Å—Ç–∏—á–Ω—ã–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞—Ä—è–¥ (Œ¥‚Åª), –∞—Ç–æ–º—ã –≤–æ–¥–æ—Ä–æ–¥–∞ ‚Äî —á–∞—Å—Ç–∏—á–Ω—ã–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π (Œ¥‚Å∫). –î–∏–ø–æ–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç: 1.85 D (–¥–µ–±–∞–π).</p>
                    </div>
                    <div class="info-section">
                        <strong>–¢–∏–ø –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏–∏:</strong>
                        <p>sp¬≥-–≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏—è –∫–∏—Å–ª–æ—Ä–æ–¥–∞. –ß–µ—Ç—ã—Ä–µ sp¬≥-–æ—Ä–±–∏—Ç–∞–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –∫ –≤–µ—Ä—à–∏–Ω–∞–º —Ç–µ—Ç—Ä–∞—ç–¥—Ä–∞: –¥–≤–µ –∑–∞–Ω—è—Ç—ã —Å–≤—è–∑—è–º–∏ O-H, –¥–≤–µ ‚Äî –Ω–µ–ø–æ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–∏.</p>
                    </div>
                    <div class="info-section">
                        <strong>–í–æ–¥–æ—Ä–æ–¥–Ω—ã–µ —Å–≤—è–∑–∏:</strong>
                        <p>–ö–∞–∂–¥–∞—è –º–æ–ª–µ–∫—É–ª–∞ –≤–æ–¥—ã –º–æ–∂–µ—Ç –æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –¥–æ 4 –≤–æ–¥–æ—Ä–æ–¥–Ω—ã—Ö —Å–≤—è–∑–µ–π: 2 —á–µ—Ä–µ–∑ –∞—Ç–æ–º—ã –≤–æ–¥–æ—Ä–æ–¥–∞ –∏ 2 —á–µ—Ä–µ–∑ –Ω–µ–ø–æ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–∞—Ä—ã –∫–∏—Å–ª–æ—Ä–æ–¥–∞.</p>
                    </div>
                    <div class="info-section">
                        <strong>–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞:</strong>
                        <p>‚Ä¢ –í—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∏–ø–µ–Ω–∏—è (100¬∞C)<br>
                        ‚Ä¢ –í—ã—Å–æ–∫–∞—è —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç—å<br>
                        ‚Ä¢ –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –ª—å–¥–∞ –º–µ–Ω—å—à–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∂–∏–¥–∫–æ–π –≤–æ–¥—ã<br>
                        ‚Ä¢ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—å<br>
                        ‚Ä¢ –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ –Ω–∞—Ç—è–∂–µ–Ω–∏–µ</p>
                    </div>
                    <div class="info-section">
                        <strong>–ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∂–∏–∑–Ω–∏:</strong>
                        <p>–í–æ–¥–∞ ‚Äî –æ—Å–Ω–æ–≤–∞ –≤—Å–µ–π –∂–∏–∑–Ω–∏ –Ω–∞ –ó–µ–º–ª–µ. –°–æ—Å—Ç–∞–≤–ª—è–µ—Ç ~60% –º–∞—Å—Å—ã —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ —Ç–µ–ª–∞.</p>
                    </div>
                `
        }
    };

    // Three.js
    let scene, camera, renderer;
    let moleculeGroup;
    let atoms = {};
    let bonds = [];
    let dipoleArrow = null;
    let electronClouds = [];
    let chargeLabels = [];
    let angleIndicators = [];
    let raycaster, mouse;
    let selectedPart = null;
    let isDragging = false;
    let previousMousePosition = {x: 0, y: 0};
    let animationPaused = false;
    let showDipole = true;
    let showElectrons = false;
    let showCharges = false;
    let showAngles = false;

    function init() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0d1b2a);

        camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 6);

        const container = document.getElementById('canvas-container');
        renderer = new THREE.WebGLRenderer({antialias: true});
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);

        // –û—Å–≤–µ—â–µ–Ω–∏–µ
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);

        const light1 = new THREE.DirectionalLight(0xffffff, 0.8);
        light1.position.set(5, 5, 5);
        scene.add(light1);

        const light2 = new THREE.DirectionalLight(0xffffff, 0.5);
        light2.position.set(-5, -3, -5);
        scene.add(light2);

        const light3 = new THREE.PointLight(0x3498db, 0.6, 20);
        light3.position.set(0, 3, 3);
        scene.add(light3);

        moleculeGroup = new THREE.Group();
        scene.add(moleculeGroup);

        createWaterMolecule();

        raycaster = new THREE.Raycaster();
        mouse = new THREE.Vector2();

        window.addEventListener('resize', onWindowResize);
        renderer.domElement.addEventListener('click', onMouseClick);
        renderer.domElement.addEventListener('mousemove', onMouseMove);
        renderer.domElement.addEventListener('mousedown', onMouseDown);
        renderer.domElement.addEventListener('mouseup', onMouseUp);
        renderer.domElement.addEventListener('wheel', onWheel);
        window.addEventListener('keydown', onKeyDown);

        animate();
    }

    function createWaterMolecule() {
        // –ê–¢–û–ú –ö–ò–°–õ–û–†–û–î–ê (—Ü–µ–Ω—Ç—Ä)
        const oxygenGeom = new THREE.SphereGeometry(0.6, 32, 32);
        const oxygenMat = new THREE.MeshPhongMaterial({
            color: 0xff4444,
            emissive: 0xcc0000,
            emissiveIntensity: 0.3,
            shininess: 100,
            specular: 0xffffff
        });
        const oxygen = new THREE.Mesh(oxygenGeom, oxygenMat);
        oxygen.position.set(0, 0, 0);
        oxygen.userData = {type: 'oxygen'};
        moleculeGroup.add(oxygen);
        atoms.oxygen = oxygen;

        // –ê–¢–û–ú–´ –í–û–î–û–†–û–î–ê
        // –£–≥–æ–ª —Å–≤—è–∑–∏ 104.5 –≥—Ä–∞–¥—É—Å–æ–≤
        const angle = (104.5 * Math.PI) / 180;
        const bondLength = 1.8;

        const h1Geom = new THREE.SphereGeometry(0.35, 32, 32);
        const h1Mat = new THREE.MeshPhongMaterial({
            color: 0xe8f4f8,
            emissive: 0xb8d4e8,
            emissiveIntensity: 0.2,
            shininess: 100,
            specular: 0xffffff
        });
        const hydrogen1 = new THREE.Mesh(h1Geom, h1Mat);
        hydrogen1.position.set(
                bondLength * Math.sin(angle / 2),
                bondLength * Math.cos(angle / 2),
                0
        );
        hydrogen1.userData = {type: 'hydrogen', id: 1};
        moleculeGroup.add(hydrogen1);
        atoms.hydrogen1 = hydrogen1;

        const hydrogen2 = new THREE.Mesh(h1Geom.clone(), h1Mat.clone());
        hydrogen2.position.set(
                -bondLength * Math.sin(angle / 2),
                bondLength * Math.cos(angle / 2),
                0
        );
        hydrogen2.userData = {type: 'hydrogen', id: 2};
        moleculeGroup.add(hydrogen2);
        atoms.hydrogen2 = hydrogen2;

        // –ö–û–í–ê–õ–ï–ù–¢–ù–´–ï –°–í–Ø–ó–ò
        createBond(oxygen.position, hydrogen1.position);
        createBond(oxygen.position, hydrogen2.position);

        // –≠–õ–ï–ö–¢–†–û–ù–ù–´–ï –û–ë–õ–ê–ö–ê (–Ω–µ–ø–æ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–∞—Ä—ã)
        createElectronClouds();

        // –î–ò–ü–û–õ–¨
        createDipoleArrow();

        // –ß–ê–°–¢–ò–ß–ù–´–ï –ó–ê–†–Ø–î–´
        createChargeLabels();

        // –ò–ù–î–ò–ö–ê–¢–û–†–´ –£–ì–õ–û–í
        createAngleIndicators();
    }

    function createBond(pos1, pos2) {
        const direction = new THREE.Vector3().subVectors(pos2, pos1);
        const length = direction.length();
        const bondGeom = new THREE.CylinderGeometry(0.08, 0.08, length, 16);
        const bondMat = new THREE.MeshPhongMaterial({
            color: 0xcccccc,
            shininess: 50
        });
        const bond = new THREE.Mesh(bondGeom, bondMat);

        bond.position.copy(pos1).add(direction.multiplyScalar(0.5));
        bond.lookAt(pos2);
        bond.rotateX(Math.PI / 2);

        moleculeGroup.add(bond);
        bonds.push(bond);
    }

    function createElectronClouds() {
        // –î–≤–µ –Ω–µ–ø–æ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–∞—Ä—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–≤ –Ω–∞ –∫–∏—Å–ª–æ—Ä–æ–¥–µ
        const cloudGeom = new THREE.SphereGeometry(0.35, 24, 24);
        const cloudMat = new THREE.MeshBasicMaterial({
            color: 0xff6666,
            transparent: true,
            opacity: 0.3,
            side: THREE.BackSide
        });

        // –ù–µ–ø–æ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–∞—Ä—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–Ω–∏–∑ –ø–æ–¥ —É–≥–ª–æ–º
        const cloud1 = new THREE.Mesh(cloudGeom, cloudMat);
        cloud1.position.set(0.5, -0.7, 0);
        cloud1.visible = showElectrons;
        moleculeGroup.add(cloud1);
        electronClouds.push(cloud1);

        const cloud2 = new THREE.Mesh(cloudGeom, cloudMat.clone());
        cloud2.position.set(-0.5, -0.7, 0);
        cloud2.visible = showElectrons;
        moleculeGroup.add(cloud2);
        electronClouds.push(cloud2);
    }

    function createDipoleArrow() {
        // –°—Ç—Ä–µ–ª–∫–∞ –¥–∏–ø–æ–ª—è –æ—Ç Œ¥‚Å∫ –∫ Œ¥‚Åª
        const arrowGroup = new THREE.Group();

        // –õ–∏–Ω–∏—è
        const lineGeom = new THREE.CylinderGeometry(0.04, 0.04, 2.2, 12);
        const lineMat = new THREE.MeshBasicMaterial({color: 0xffff00});
        const line = new THREE.Mesh(lineGeom, lineMat);
        line.position.set(0, 0.3, 0);
        arrowGroup.add(line);

        // –ù–∞–∫–æ–Ω–µ—á–Ω–∏–∫
        const coneGeom = new THREE.ConeGeometry(0.15, 0.3, 16);
        const coneMat = new THREE.MeshBasicMaterial({color: 0xffff00});
        const cone = new THREE.Mesh(coneGeom, coneMat);
        cone.position.set(0, -0.9, 0);
        cone.rotation.x = Math.PI;
        arrowGroup.add(cone);

        // –ü–ª—é—Å –≤–≤–µ—Ä—Ö—É
        const plusGeom = new THREE.TorusGeometry(0.12, 0.03, 12, 24);
        const plus1 = new THREE.Mesh(plusGeom, new THREE.MeshBasicMaterial({color: 0xff0000}));
        plus1.position.set(0, 1.5, 0);
        arrowGroup.add(plus1);

        const plus2 = new THREE.Mesh(plusGeom, new THREE.MeshBasicMaterial({color: 0xff0000}));
        plus2.position.set(0, 1.5, 0);
        plus2.rotation.z = Math.PI / 2;
        arrowGroup.add(plus2);

        // –ú–∏–Ω—É—Å –≤–Ω–∏–∑—É
        const minusGeom = new THREE.BoxGeometry(0.25, 0.05, 0.05);
        const minus = new THREE.Mesh(minusGeom, new THREE.MeshBasicMaterial({color: 0x0000ff}));
        minus.position.set(0, -0.95, 0);
        arrowGroup.add(minus);

        arrowGroup.visible = showDipole;
        moleculeGroup.add(arrowGroup);
        dipoleArrow = arrowGroup;
    }

    function createChargeLabels() {
        // –°–æ–∑–¥–∞—ë–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è —á–∞—Å—Ç–∏—á–Ω—ã—Ö –∑–∞—Ä—è–¥–æ–≤
        // (–£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ THREE.TextGeometry)
        // –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–ª–µ–Ω—å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

        // Œ¥‚Åª –Ω–∞ –∫–∏—Å–ª–æ—Ä–æ–¥–µ
        const negGeom = new THREE.SphereGeometry(0.1, 16, 16);
        const negMat = new THREE.MeshBasicMaterial({color: 0x0000ff});
        const negCharge = new THREE.Mesh(negGeom, negMat);
        negCharge.position.set(-0.7, -0.3, 0);
        negCharge.visible = showCharges;
        moleculeGroup.add(negCharge);
        chargeLabels.push(negCharge);

        // Œ¥‚Å∫ –Ω–∞ –≤–æ–¥–æ—Ä–æ–¥–∞—Ö
        const posGeom = new THREE.SphereGeometry(0.08, 16, 16);
        const posMat = new THREE.MeshBasicMaterial({color: 0xff0000});

        const posCharge1 = new THREE.Mesh(posGeom, posMat);
        posCharge1.position.set(
                atoms.hydrogen1.position.x + 0.3,
                atoms.hydrogen1.position.y + 0.3,
                0
        );
        posCharge1.visible = showCharges;
        moleculeGroup.add(posCharge1);
        chargeLabels.push(posCharge1);

        const posCharge2 = new THREE.Mesh(posGeom, posMat.clone());
        posCharge2.position.set(
                atoms.hydrogen2.position.x - 0.3,
                atoms.hydrogen2.position.y + 0.3,
                0
        );
        posCharge2.visible = showCharges;
        moleculeGroup.add(posCharge2);
        chargeLabels.push(posCharge2);
    }

    function createAngleIndicators() {
        // –î—É–≥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è —É–≥–æ–ª 104.5¬∞
        const curve = new THREE.EllipseCurve(
                0, 0,
                0.8, 0.8,
                0, (104.5 * Math.PI) / 180,
                false,
                Math.PI / 2
        );

        const points = curve.getPoints(50);
        const geometry = new THREE.BufferGeometry().setFromPoints(points);
        const material = new THREE.LineBasicMaterial({color: 0x00ff00, linewidth: 2});
        const arc = new THREE.Line(geometry, material);
        arc.rotation.z = -(104.5 * Math.PI) / 360;
        arc.visible = showAngles;
        moleculeGroup.add(arc);
        angleIndicators.push(arc);
    }

    function toggleDipole() {
        showDipole = !showDipole;
        if (dipoleArrow) dipoleArrow.visible = showDipole;
        updateButton(0, showDipole);
    }

    function toggleElectronCloud() {
        showElectrons = !showElectrons;
        electronClouds.forEach(cloud => cloud.visible = showElectrons);
        updateButton(1, showElectrons);
    }

    function toggleCharges() {
        showCharges = !showCharges;
        chargeLabels.forEach(label => label.visible = showCharges);
        updateButton(2, showCharges);
    }

    function toggleAngles() {
        showAngles = !showAngles;
        angleIndicators.forEach(indicator => indicator.visible = showAngles);
        updateButton(3, showAngles);
    }

    function updateButton(index, active) {
        const buttons = document.querySelectorAll('.view-btn');
        if (buttons[index]) {
            buttons[index].classList.toggle('active', active);
        }
    }

    function onMouseDown(e) {
        isDragging = true;
        previousMousePosition = {x: e.clientX, y: e.clientY};
    }

    function onMouseUp() {
        isDragging = false;
    }

    function onMouseMove(e) {
        mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;

        if (isDragging) {
            const deltaX = e.clientX - previousMousePosition.x;
            const deltaY = e.clientY - previousMousePosition.y;
            moleculeGroup.rotation.y += deltaX * 0.005;
            moleculeGroup.rotation.x += deltaY * 0.005;
            previousMousePosition = {x: e.clientX, y: e.clientY};
        }

        raycaster.setFromCamera(mouse, camera);
        const intersects = raycaster.intersectObjects([atoms.oxygen, atoms.hydrogen1, atoms.hydrogen2]);
        document.body.style.cursor = intersects.length > 0 ? 'pointer' : 'default';
    }

    function onMouseClick(e) {
        mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);
        const intersects = raycaster.intersectObjects([atoms.oxygen, atoms.hydrogen1, atoms.hydrogen2]);

        if (intersects.length > 0) {
            const atom = intersects[0].object;
            const type = atom.userData.type;
            showInfo(type);
            highlightPart(atom);
        } else {
            showInfo('molecule');
        }
    }

    function onWheel(e) {
        e.preventDefault();
        camera.position.z += e.deltaY * 0.005;
        camera.position.z = Math.max(3, Math.min(12, camera.position.z));
    }

    function onKeyDown(e) {
        if (e.code === 'Space') {
            e.preventDefault();
            animationPaused = !animationPaused;
        }
    }

    function showInfo(type) {
        const info = atomInfo[type];
        if (info) {
            document.getElementById('info-title').textContent = info.title;
            document.getElementById('info-content').innerHTML = info.content;
            document.getElementById('info-panel').classList.add('active');
        }
    }

    function closeInfo() {
        document.getElementById('info-panel').classList.remove('active');
        if (selectedPart) {
            const originalColor = selectedPart.userData.type === 'oxygen' ? 0xcc0000 : 0xb8d4e8;
            selectedPart.material.emissive.setHex(originalColor);
            selectedPart.material.emissiveIntensity = selectedPart.userData.type === 'oxygen' ? 0.3 : 0.2;
            selectedPart = null;
        }
    }

    function highlightPart(atom) {
        if (selectedPart) {
            const originalColor = selectedPart.userData.type === 'oxygen' ? 0xcc0000 : 0xb8d4e8;
            selectedPart.material.emissive.setHex(originalColor);
            selectedPart.material.emissiveIntensity = selectedPart.userData.type === 'oxygen' ? 0.3 : 0.2;
        }
        atom.material.emissive.setHex(0xffffff);
        atom.material.emissiveIntensity = 0.7;
        selectedPart = atom;
    }

    function focusPart(type) {
        if (type === 'oxygen') {
            showInfo('oxygen');
            highlightPart(atoms.oxygen);
        } else if (type === 'hydrogen') {
            showInfo('hydrogen');
            highlightPart(atoms.hydrogen1);
        }
    }

    function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
        requestAnimationFrame(animate);

        if (!animationPaused) {
            moleculeGroup.rotation.y += 0.003;
        }

        renderer.render(scene, camera);
    }

    window.addEventListener('load', init);
</script>
</body>
</html>