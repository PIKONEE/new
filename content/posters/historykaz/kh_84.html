<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Завершение колониального захвата Казахстана (XIX в.)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Inter:wght@300;400;600&display=swap&subset=cyrillic,cyrillic-ext" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0c0a09; color: #f5f5f4; }
        h1, h2, h3 { font-family: 'Montserrat', sans-serif; }

        .war-gradient {
            background: radial-gradient(circle at top right, #450a0a, #0c0a09 85%);
        }

        .premium-card {
            background: rgba(28, 25, 23, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 3rem;
            border: 2px solid #991b1b;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .premium-card:hover {
            border-color: #dc2626;
            box-shadow: 0 0 60px rgba(153, 27, 27, 0.2);
        }

        .lang-active {
            background-color: #991b1b;
            color: white;
            box-shadow: 0 0 20px rgba(153, 27, 27, 0.5);
        }

        canvas {
            cursor: crosshair;
            border-radius: 2.5rem;
            background: #1c1917;
            box-shadow: inset 0 0 40px rgba(0,0,0,0.6);
        }

        .info-panel {
            background: rgba(30, 41, 59, 0.4);
            border-left: 10px solid #991b1b;
            padding: 2.5rem;
            border-radius: 2.5rem;
        }

        .status-badge {
            background: #450a0a;
            color: #fca5a5;
            padding: 4px 14px;
            border-radius: 99px;
            font-size: 0.75rem;
            font-weight: 800;
            text-transform: uppercase;
        }
    </style>
</head>
<body class="war-gradient min-h-screen pb-20">

    <header class="sticky top-0 z-50 bg-black/60 backdrop-blur-xl border-b border-red-900/30 px-6 py-5">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6">
            <h1 id="main-title" class="text-xl md:text-2xl font-black uppercase tracking-[0.1em] text-red-500 text-center">Завершение колониального захвата Казахстана</h1>
            <div class="flex bg-zinc-900 p-1 rounded-xl border border-red-900/30">
                <button onclick="setLang('ru')" id="btn-ru" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">RU</button>
                <button onclick="setLang('kz')" id="btn-kz" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">KZ</button>
                <button onclick="setLang('en')" id="btn-en" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">EN</button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-12 space-y-16">
        
        <!-- Section 1: Tactical Map Analysis (Canvas) -->
        <div class="premium-card p-8 md:p-12 shadow-sm">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-12 items-center">
                <div class="lg:col-span-5 space-y-8">
                    <div id="badge" class="inline-block border border-red-500 text-red-500 px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-widest">Southern Frontier Final Phase</div>
                    <h2 id="viz-title" class="text-3xl md:text-4xl font-black text-white leading-tight uppercase italic tracking-tighter">Карта Южного Прорыва</h2>
                    <p id="viz-desc" class="text-lg text-zinc-400 font-light leading-relaxed">
                        В 1860-х годах Российская империя нанесла финальный удар по Кокандскому ханству, захватив южные земли Казахстана. Нажмите на опорные пункты для анализа военной кампании.
                    </p>
                    
                    <div id="info-panel" class="info-panel shadow-2xl transition-all duration-500">
                        <h3 id="element-title" class="text-xl font-bold text-red-400 mb-3 uppercase">Выберите рубеж</h3>
                        <p id="element-desc" class="text-zinc-300 text-sm leading-relaxed italic font-light">Кликните на Шымкент, Туркестан или Аулие-Ату на чертеже справа.</p>
                    </div>
                </div>
                
                <div class="lg:col-span-7 p-4 flex items-center justify-center relative min-h-[550px]">
                    <canvas id="warCanvas"></canvas>
                    <div class="absolute bottom-8 right-12 text-[10px] text-red-900 font-mono uppercase tracking-[0.4em]">Military Annexation Model 1864-1881</div>
                </div>
            </div>
        </div>

        <!-- Section 2: Deep Context Blocks -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
            <!-- Military Campaign -->
            <div class="premium-card p-10 border-t-8 border-red-600">
                <span class="status-badge mb-4 inline-block" id="tag-1">Кампания</span>
                <h3 id="c1-t" class="text-xl font-bold mb-4 uppercase text-white">Удар 1864 года</h3>
                <p id="c1-d" class="text-zinc-400 text-sm leading-relaxed">
                    Двустороннее наступление отрядов полковника **Черняева** (из Верного) и полковника **Веревкина** (из Перовска) привело к взятию крупнейших крепостей юга. Падение **Туркестана**, **Шымкента** и **Аулие-Аты** ознаменовало военное поражение Коканда и включение южных казахов в состав империи.
                </p>
            </div>

            <!-- Borders -->
            <div class="premium-card p-10 border-t-8 border-slate-500">
                <span class="status-badge mb-4 inline-block" id="tag-2">Границы</span>
                <h3 id="c2-t" class="text-xl font-bold mb-4 uppercase text-white">Петербургский договор</h3>
                <p id="c2-d" class="text-zinc-400 text-sm leading-relaxed">
                    В **1881 году** был подписан Петербургский договор с Китаем. Он окончательно разграничил владения России и Цинской империи в Центральной Азии. Казахстан официально обрел современные восточные границы. Кочевые пути были разрезаны государственными рубежами, что навсегда изменило экономику Степи.
                </p>
            </div>

            <!-- Consequences -->
            <div class="premium-card p-10 border-t-8 border-red-600">
                <span class="status-badge mb-4 inline-block" id="tag-3">Итоги</span>
                <h3 id="c3-t" class="text-xl font-bold mb-4 uppercase text-white">Колониальный финал</h3>
                <p id="c3-d" class="text-zinc-400 text-sm leading-relaxed">
                    Завершение захвата превратило Казахстан в сырьевой придаток. Вся полнота власти перешла к военным губернаторам. Изъятие земель под переселенческие участки (фонд Куропаткина) приняло катастрофические масштабы. Кочевники потеряли лучшие пастбища, что стало причиной будущих восстаний XX века.
                </p>
            </div>
        </div>
    </main>

    <footer class="mt-20 py-24 bg-black border-t border-red-900/30 text-center">
        <div class="max-w-4xl mx-auto px-6">
            <p id="footer-text" class="text-2xl md:text-3xl font-light italic leading-tight text-slate-500">
                «Финальный рубеж XIX века стер последние следы суверенитета Степи, превратив её в имперскую провинцию, зажатую между законами Петербурга и ресурсами Востока.»
            </p>
            <div class="mt-12 h-1 w-24 bg-red-900 mx-auto rounded-full"></div>
        </div>
    </footer>

    <script>
        const translations = {
            ru: {
                title: "Завершение колониального захвата Казахстана",
                vizTitle: "Карта Южного Прорыва",
                vizDesc: "В 1864-1881 гг. империя замкнула кольцо границ. Нажмите на точки для анализа штурма крепостей и дипломатических актов.",
                badge: "Анализ финальной фазы экспансии",
                elementTitleDefault: "Выберите рубеж",
                elementDescDefault: "Кликните на Шымкент, Туркестан или Аулие-Ату на чертеже справа.",
                tag1: "Кампания", tag2: "Границы", tag3: "Итоги",
                c1T: "Удар 1864 года", c1D: "Соединение Оренбургской и Сибирской линий. Черняев и Веревкин штурмовали Шымкент и Туркестан, ликвидировав кокандское влияние в Семиречье.",
                c2T: "Петербургский договор", c2D: "1881 г. Окончательное установление границы с Китаем. Россия получила контроль над бассейном реки Или и озером Зайсан.",
                c3T: "Колониальный финал", c3D: "Полное административное подчинение. Введение Степного положения 1891 г. Земля объявлена собственностью короны.",
                footer: "«Финальный рубеж XIX века стер последние следы суверенитета Степи.»",
                nodes: {
                    shymkent: { name: "Шымкент (1864)", text: "Ключевая кокандская крепость. Взята штурмом отрядом Черняева. Это падение открыло путь к Ташкенту." },
                    turkestan: { name: "Туркестан (1864)", text: "Священный город пал после короткой осады отряда Веревкина. Центр юга перешел под контроль России." },
                    border: { name: "Линия 1881 года", text: "Окончательная граница с Цинской империей. Разделение родов и пастбищ международным договором." }
                }
            },
            kz: {
                title: "Қазақстанды отарлаудың аяқталуы",
                vizTitle: "Оңтүстік бетбұрыс картасы",
                vizDesc: "1864-1881 жж. империя шекара шеңберін тұйықтады. Бекіністерді алу мен дипломатиялық актілерді талдау үшін нүктелерді басыңыз.",
                badge: "Экспансияның соңғы кезеңін талдау",
                elementTitleDefault: "Шекті таңдаңыз",
                elementDescDefault: "Оң жақтағы сызбадан Шымкент, Түркістан немесе Әулиеатаны басыңыз.",
                tag1: "Науқан", tag2: "Шекара", tag3: "Қорытынды",
                c1T: "1864 жылғы соққы", c1D: "Орынбор және Сібір шептерінің қосылуы. Черняев пен Веревкин Шымкент пен Түркістанды алып, Жетісудағы Қоқан ықпалын жойды.",
                c2T: "Петербург келісімі", c2D: "1881 ж. Қытаймен шекараның түпкілікті белгіленуі. Ресей Іле алабы мен Зайсан көліне бақылау орнатты.",
                c3T: "Отарлаудың соңы", c3D: "Толық әкімшілік бағыныштылық. 1891 жылғы Дала ережесінің енгізілуі. Жер мемлекет меншігі болып жарияланды.",
                footer: "«XIX ғасырдың соңғы белесі Дала егемендігінің соңғы ізін өшірді.»",
                nodes: {
                    shymkent: { name: "Шымкент (1864)", text: "Қоқанның басты бекінісі. Черняев жасағының штурмымен алынды. Бұл Ташкентке жол ашты." },
                    turkestan: { name: "Түркістан (1864)", text: "Қасиетті қала Веревкин жасағының қоршауынан кейін құлады. Оңтүстік орталығы Ресей бақылауына өтті." },
                    border: { name: "1881 жылғы шеп", text: "Цин империясымен түпкілікті шекара. Халықаралық келісіммен рулар мен жайылымдардың бөлінуі." }
                }
            },
            en: {
                title: "Completion of the Colonial Conquest of Kazakhstan",
                vizTitle: "Southern Breakthrough Map",
                vizDesc: "In 1864-1881, the Empire closed the border ring. Click on nodes to analyze the storming of fortresses and diplomatic acts.",
                badge: "Final Expansion Phase Analysis",
                elementTitleDefault: "Select a Frontier",
                elementDescDefault: "Click on Shymkent, Turkestan, or Auliye-Ata on the schematic.",
                tag1: "Campaign", tag2: "Borders", tag3: "Outcomes",
                c1T: "Strike of 1864", c1D: "Merging of Orenburg and Siberian lines. Chernyaev and Verevkin stormed Shymkent and Turkestan, ending Kokand influence.",
                c2T: "Treaty of St. Petersburg", c2D: "1881. Final demarcation of the border with China. Russia gained control over the Ili basin and Lake Zaisan.",
                c3T: "Colonial Finale", c3D: "Total administrative subordination. 1891 Steppe Statute. All land declared crown property.",
                footer: "«The final frontier of the 19th century erased the last traces of Steppe sovereignty.»",
                nodes: {
                    shymkent: { name: "Shymkent (1864)", text: "A key Kokand fortress. Stormed by Chernyaev's detachment, opening the route to Tashkent." },
                    turkestan: { name: "Turkestan (1864)", text: "The sacred city fell after a short siege by Verevkin. The southern core moved under Russian control." },
                    border: { name: "1881 Border Line", text: "Final demarcation with the Qing Empire. Clans and pastures were split by an international treaty." }
                }
            }
        };

        let currentLang = 'ru';
        const canvas = document.getElementById('warCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            canvas.width = canvas.parentElement.clientWidth;
            canvas.height = 550;
            drawWarMap();
        }

        function drawWarMap() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;
            const scale = canvas.width / 800;

            // 1. Draw Abstract Southern Border (Curved Line)
            ctx.beginPath();
            ctx.moveTo(100 * scale, 450 * scale);
            ctx.quadraticCurveTo(cx, 350 * scale, 700 * scale, 420 * scale);
            ctx.strokeStyle = 'rgba(153, 27, 27, 0.4)';
            ctx.lineWidth = 15 * scale;
            ctx.stroke();

            // 2. Battle Nodes
            drawPoint(250 * scale, 380 * scale, '#991b1b', "TURKESTAN", 'turkestan');
            drawPoint(450 * scale, 370 * scale, '#dc2626', "SHYMKENT", 'shymkent');
            drawPoint(650 * scale, 400 * scale, '#7f1d1d', "TREATY 1881", 'border');

            // 3. Movement Vectors
            drawArrow(100 * scale, 300 * scale, 230 * scale, 360 * scale, '#dc2626'); // From North-West
            drawArrow(700 * scale, 250 * scale, 470 * scale, 350 * scale, '#dc2626'); // From North-East
        }

        function drawPoint(x, y, color, label, id) {
            ctx.beginPath();
            ctx.arc(x, y, 15 * canvas.width/800, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            ctx.fillStyle = color;
            ctx.font = 'bold 10px Montserrat';
            ctx.textAlign = 'center';
            ctx.fillText(label, x, y + 35 * canvas.width/800);
        }

        function drawArrow(fx, fy, tx, ty, color) {
            const headlen = 15;
            const angle = Math.atan2(ty - fy, tx - fx);
            ctx.beginPath();
            ctx.moveTo(fx, fy);
            ctx.lineTo(tx, ty);
            ctx.strokeStyle = color;
            ctx.lineWidth = 3;
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(tx, ty);
            ctx.lineTo(tx - headlen * Math.cos(angle - Math.PI / 6), ty - headlen * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(tx - headlen * Math.cos(angle + Math.PI / 6), ty - headlen * Math.sin(angle + Math.PI / 6));
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();
        }

        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const scale = canvas.width / 800;

            let target = null;
            if (x < 350 * scale) target = 'turkestan';
            else if (x >= 350 * scale && x < 550 * scale) target = 'shymkent';
            else target = 'border';

            if (target && translations[currentLang].nodes[target]) {
                const info = translations[currentLang].nodes[target];
                document.getElementById('element-title').innerText = info.name;
                document.getElementById('element-desc').innerText = info.text;
                document.getElementById('info-panel').style.borderColor = '#991b1b';
            }
        });

        function setLang(lang) {
            currentLang = lang;
            const t = translations[lang];
            if (!t) return;

            document.getElementById('main-title').innerText = t.title;
            document.getElementById('viz-title').innerText = t.vizTitle;
            document.getElementById('viz-desc').innerText = t.vizDesc;
            document.getElementById('badge').innerText = t.badge;
            document.getElementById('element-title').innerText = t.elementTitleDefault;
            document.getElementById('element-desc').innerText = t.elementDescDefault;
            document.getElementById('tag-1').innerText = t.tag1;
            document.getElementById('tag-2').innerText = t.tag2;
            document.getElementById('tag-3').innerText = t.tag3;
            document.getElementById('c1-t').innerText = t.c1T; document.getElementById('c1-d').innerText = t.c1D;
            document.getElementById('c2-t').innerText = t.c2T; document.getElementById('c2-d').innerText = t.c2D;
            document.getElementById('c3-t').innerText = t.c3T; document.getElementById('c3-d').innerText = t.c3D;
            document.getElementById('footer-text').innerText = t.footer;

            ['ru', 'kz', 'en'].forEach(l => {
                const btn = document.getElementById(`btn-${l}`);
                if(btn) btn.className = l === lang ? "px-6 py-2 rounded-lg text-sm font-black lang-active" : "px-6 py-2 rounded-lg text-sm font-bold text-zinc-500 hover:text-white transition-all";
            });
            resizeCanvas();
        }

        window.onload = () => setLang('ru');
        window.onresize = resizeCanvas;
    </script>
</body>
</html>