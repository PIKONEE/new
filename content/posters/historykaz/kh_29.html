<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω—Ç—Ä–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ–±–ª–∏–∫ –¥—Ä–µ–≤–Ω–∏—Ö –∂–∏—Ç–µ–ª–µ–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Inter:wght@300;400;600&display=swap&subset=cyrillic,cyrillic-ext" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8f5f2; color: #2d2a28; }
        h1, h2, h3 { font-family: 'Montserrat', sans-serif; }

        .lab-gradient {
            background: linear-gradient(135deg, #f8f5f2 0%, #e5e0db 100%);
        }

        .museum-card {
            background: white;
            border-radius: 2rem;
            border: 1px solid #d1ccc0;
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        .museum-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px -15px rgba(45, 42, 40, 0.1);
            border-color: #a8a29e;
        }

        .lang-active {
            background-color: #2d2a28;
            color: #ffffff;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
        }

        .interactive-stage {
            background: #ffffff;
            border-radius: 2.5rem;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.03);
            border: 1px solid #e5e0db;
        }

        canvas {
            cursor: pointer;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.05));
        }

        .process-btn {
            transition: all 0.3s ease;
            border: 2px solid #e5e0db;
        }
        .process-btn.active {
            background: #2d2a28;
            color: white;
            border-color: #2d2a28;
        }

        .trait-tag {
            background: #f1f0ee;
            padding: 4px 12px;
            border-radius: 99px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            color: #78716c;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body class="min-h-screen pb-20 lab-gradient">

<!-- –ö–ù–û–ü–ö–ê –ù–ê–ó–ê–î -->
<div style="position: fixed; top: 20px; left: 20px; z-index: 10000;">
    <button onclick="goBack()" style="
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 12px 24px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        transition: all 0.3s ease;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    " onmouseover="this.style.transform='translateX(-5px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.6)';" 
       onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)';">
        ‚Üê –ù–∞–∑–∞–¥
    </button>
</div>


    <!-- Header (Strict text, no emoji) -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-stone-200 px-6 py-5">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6">
            <h1 id="main-title" class="text-xl md:text-2xl font-black uppercase tracking-[0.2em] text-stone-800">–ê–Ω—Ç—Ä–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ–±–ª–∏–∫ –¥—Ä–µ–≤–Ω–∏—Ö –∂–∏—Ç–µ–ª–µ–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</h1>
            <div class="flex bg-stone-100 p-1 rounded-xl border border-stone-200">
                <button onclick="setLang('ru')" id="btn-ru" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">RU</button>
                <button onclick="setLang('kz')" id="btn-kz" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">KZ</button>
                <button onclick="setLang('en')" id="btn-en" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">EN</button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-12 space-y-16">
        
        <!-- Section 1: Interactive Reconstruction (The Map) -->
        <div class="interactive-stage p-8 md:p-12">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-12 items-center">
                <div class="lg:col-span-5 space-y-8">
                    <div id="badge" class="inline-block bg-stone-800 text-white px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-widest text-nowrap">Scientific Method: M. Gerasimov</div>
                    <h2 id="viz-title" class="text-3xl md:text-4xl font-black text-stone-900 leading-tight italic">–õ–∏—Ü–æ —Å–∫–≤–æ–∑—å –≤—Ä–µ–º—è</h2>
                    <p id="viz-desc" class="text-lg text-stone-600 font-light leading-relaxed">
                        –£–∑–Ω–∞–π—Ç–µ, –∫–∞–∫ —É—á–µ–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –æ–±–ª–∏–∫ –ø—Ä–µ–¥–∫–æ–≤. –ú–µ—Ç–æ–¥ –ø–ª–∞—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —á–µ—Ä–µ–ø—É –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 90% –≤–æ—Å—Å–æ–∑–¥–∞—Ç—å —á–µ—Ä—Ç—ã –ª–∏—Ü–∞.
                    </p>
                    
                    <div class="flex flex-wrap gap-3">
                        <button onclick="drawLayer('skull')" id="step-skull" class="process-btn active px-6 py-2 rounded-full text-xs font-bold uppercase">1. –ß–µ—Ä–µ–ø</button>
                        <button onclick="drawLayer('muscles')" id="step-muscles" class="process-btn px-6 py-2 rounded-full text-xs font-bold uppercase">2. –ú—ã—à—Ü—ã</button>
                        <button onclick="drawLayer('final')" id="step-final" class="process-btn px-6 py-2 rounded-full text-xs font-bold uppercase">3. –û–±–ª–∏–∫</button>
                    </div>

                    <div id="info-panel" class="p-8 rounded-[2rem] bg-stone-50 border-l-8 border-stone-800 shadow-sm transition-all duration-500">
                        <h3 id="layer-title" class="text-xl font-bold text-stone-800 mb-3 uppercase">–û—Å–Ω–æ–≤–∞: –ß–µ—Ä–µ–ø</h3>
                        <p id="layer-desc" class="text-stone-500 text-sm leading-relaxed italic">–ß–µ—Ä–µ–ø ‚Äî —ç—Ç–æ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç. –ï–≥–æ —Ñ–æ—Ä–º–∞ –∏ —Ä–∞–∑–º–µ—Ä—ã (–∫—Ä–∞–Ω–∏–æ–º–µ—Ç—Ä–∏—è) –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –ø–æ—Å–∞–¥–∫—É –≥–ª–∞–∑, —Ñ–æ—Ä–º—É –Ω–æ—Å–∞ –∏ —à–∏—Ä–∏–Ω—É —Å–∫—É–ª.</p>
                    </div>
                </div>
                
                <div class="lg:col-span-7 bg-stone-50 p-6 rounded-[3rem] flex items-center justify-center relative min-h-[500px]">
                    <canvas id="faceCanvas"></canvas>
                    <div class="absolute top-8 right-10 text-[10px] text-stone-400 font-mono uppercase tracking-widest">Digital Reconstruction Lab</div>
                </div>
            </div>
        </div>

        <!-- Section 2: Anthropological Content (The Plan) -->
        <div class="space-y-12">
            <h2 id="plan-title" class="text-center text-3xl font-black text-stone-800 uppercase tracking-[0.4em]">–≠–≤–æ–ª—é—Ü–∏—è —Ç–∏–ø–æ–≤</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                
                <!-- Bronze Age (Andronovo) -->
                <div class="museum-card p-10 flex flex-col justify-between border-t-8 border-stone-300">
                    <div>
                        <div class="flex gap-2 mb-4">
                            <span class="trait-tag">–ï–≤—Ä–æ–ø–µ–æ–∏–¥–Ω—ã–π</span>
                            <span class="trait-tag">–ú–∞—Å—Å–∏–≤–Ω—ã–π</span>
                        </div>
                        <h3 id="era1-t" class="text-xl font-bold mb-4 uppercase text-stone-800">–≠–ø–æ—Ö–∞ –±—Ä–æ–Ω–∑—ã</h3>
                        <p id="era1-d" class="text-stone-500 text-sm leading-relaxed">
                            –ñ–∏—Ç–µ–ª–∏ (–∞–Ω–¥—Ä–æ–Ω–æ–≤—Ü—ã) –æ–±–ª–∞–¥–∞–ª–∏ —è—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º–∏ –µ–≤—Ä–æ–ø–µ–æ–∏–¥–Ω—ã–º–∏ —á–µ—Ä—Ç–∞–º–∏: —Ä–µ–∑–∫–æ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–∏—Ü–æ, –≤—ã—Å–æ–∫–∏–π –∏ —à–∏—Ä–æ–∫–∏–π –Ω–æ—Å, –≥–ª—É–±–æ–∫–æ –ø–æ—Å–∞–∂–µ–Ω–Ω—ã–µ –≥–ª–∞–∑–∞ –∏ –¥–æ–ª–∏—Ö–æ–∫–µ—Ñ–∞–ª—å–Ω—ã–π (—É–¥–ª–∏–Ω–µ–Ω–Ω—ã–π) —á–µ—Ä–µ–ø. –û–Ω–∏ –±—ã–ª–∏ –≤—ã—Å–æ–∫–æ–≥–æ —Ä–æ—Å—Ç–∞ –∏ –º–æ—â–Ω–æ–≥–æ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏—è.
                        </p>
                    </div>
                </div>

                <!-- Early Iron Age (Saka) -->
                <div class="museum-card p-10 flex flex-col justify-between border-t-8 border-stone-500">
                    <div>
                        <div class="flex gap-2 mb-4">
                            <span class="trait-tag">–ú–µ—Ç–∏—Å–Ω—ã–π</span>
                            <span class="trait-tag">–ü–µ—Ä–µ—Ö–æ–¥–Ω—ã–π</span>
                        </div>
                        <h3 id="era2-t" class="text-xl font-bold mb-4 uppercase text-stone-800">–†–∞–Ω–Ω–µ–µ –∂–µ–ª–µ–∑–æ</h3>
                        <p id="era2-d" class="text-stone-500 text-sm leading-relaxed">
                            –£ —Å–∞–∫—Å–∫–∏—Ö –ø–ª–µ–º–µ–Ω –Ω–∞—á–∏–Ω–∞—é—Ç –ø—Ä–æ—è–≤–ª—è—Ç—å—Å—è –ø–µ—Ä–≤—ã–µ –º–æ–Ω–≥–æ–ª–æ–∏–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (—É–ø–ª–æ—â–µ–Ω–∏–µ –ª–∏—Ü–∞, –≤—ã—Å—Ç—É–ø–∞—é—â–∏–µ —Å–∫—É–ª—ã), –Ω–æ –µ–≤—Ä–æ–ø–µ–æ–∏–¥–Ω–∞—è –æ—Å–Ω–æ–≤–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–º–µ—à–µ–Ω–∏—è (–º–µ—Ç–∏—Å–∞—Ü–∏–∏) –Ω–∞–∏–±–æ–ª–µ–µ –∑–∞–º–µ—Ç–µ–Ω –≤ –í–æ—Å—Ç–æ—á–Ω–æ–º –∏ –°–µ–≤–µ—Ä–Ω–æ–º –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ.
                        </p>
                    </div>
                </div>

                <!-- Huns and Sarmatians -->
                <div class="museum-card p-10 flex flex-col justify-between border-t-8 border-stone-800">
                    <div>
                        <div class="flex gap-2 mb-4">
                            <span class="trait-tag">–ú–æ–Ω–≥–æ–ª–æ–∏–¥–Ω—ã–π</span>
                            <span class="trait-tag">–ë—Ä–∞—Ö–∏–∫–µ—Ñ–∞–ª–∏—è</span>
                        </div>
                        <h3 id="era3-t" class="text-xl font-bold mb-4 uppercase text-stone-800">–≠–ø–æ—Ö–∞ –ì—É–Ω–Ω–æ–≤</h3>
                        <p id="era3-d" class="text-stone-500 text-sm leading-relaxed">
                            –° –ø—Ä–∏—Ö–æ–¥–æ–º –≥—É–Ω–Ω–æ–≤ –∏–∑ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ê–∑–∏–∏ –º–æ–Ω–≥–æ–ª–æ–∏–¥–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–º. –õ–∏—Ü–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —à–∏—Ä–µ, –Ω–æ—Å –º–µ–Ω–µ–µ –≤—ã—Å—Ç—É–ø–∞—é—â–∏–º, –ø–æ—è–≤–ª—è–µ—Ç—Å—è —ç–ø–∏–∫–∞–Ω—Ç—É—Å. –§–æ—Ä–º–∞ —á–µ—Ä–µ–ø–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –±—Ä–∞—Ö–∏–∫–µ—Ñ–∞–ª—å–Ω—É—é (–æ–∫—Ä—É–≥–ª—É—é).
                        </p>
                    </div>
                </div>

            </div>

            <!-- Full Width Deep Info: Science and Genetics -->
            <div class="bg-stone-900 rounded-[4rem] p-10 md:p-20 shadow-2xl relative overflow-hidden text-white">
                <div class="relative z-10 grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                    <div>
                        <h3 id="feat-title" class="text-3xl font-black mb-8 uppercase italic tracking-widest text-stone-200">–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–¥ –Ω–∞—Ü–∏–∏</h3>
                        <p id="feat-desc" class="text-stone-400 text-xl font-light leading-relaxed">
                            –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –î–ù–ö-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç: –∞–Ω—Ç—Ä–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ–±–ª–∏–∫ –∫–∞–∑–∞—Ö–æ–≤ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ —Å—Ç—ã–∫–µ –¥–≤—É—Ö –≤–µ–ª–∏–∫–∏—Ö —Ä–∞—Å. –≠—Ç–æ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–ø–ª–∞–≤ –æ–±–µ—Å–ø–µ—á–∏–ª –Ω–∞—Ä–æ–¥—É –≤—ã—Å–æ–∫—É—é –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ —É—Å–ª–æ–≤–∏—è–º —Å—Ç–µ–ø–∏. –ü—Ä–æ—Ü–µ—Å—Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –∫ XIV‚ÄìXV –≤–µ–∫–∞–º.
                        </p>
                    </div>
                    <div class="grid grid-cols-1 gap-6">
                        <div class="p-6 bg-white/5 rounded-3xl border border-white/10">
                            <div id="sci-1-t" class="text-xs font-black mb-2 uppercase text-stone-500">–ö—Ä–∞–Ω–∏–æ–º–µ—Ç—Ä–∏—è</div>
                            <div id="sci-1-d" class="text-sm font-medium text-stone-300 italic">–ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–ø–∞ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ø—É–ª—è—Ü–∏–π.</div>
                        </div>
                        <div class="p-6 bg-white/5 rounded-3xl border border-white/10">
                            <div id="sci-2-t" class="text-xs font-black mb-2 uppercase text-stone-500">–û–¥–æ–Ω—Ç–æ–ª–æ–≥–∏—è</div>
                            <div id="sci-2-d" class="text-sm font-medium text-stone-300 italic">–ò–∑—É—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–µ–Ω–∏—è –∑—É–±–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–º–æ–≥–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–æ–¥—Å—Ç–≤–æ –ø–ª–µ–º–µ–Ω.</div>
                        </div>
                    </div>
                </div>
                <div class="absolute -bottom-20 -right-20 text-[20rem] opacity-5 font-black rotate-12">GENOME</div>
            </div>
        </div>

    </main>

    <footer class="mt-20 py-24 bg-stone-100 border-t border-stone-200 text-center text-stone-400">
        <div class="max-w-4xl mx-auto px-6">
            <p id="footer-text" class="text-2xl md:text-3xl font-light italic leading-tight">
                ¬´–õ–∏—Ü–∞ –¥—Ä–µ–≤–Ω–∏—Ö –∂–∏—Ç–µ–ª–µ–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ ‚Äî —ç—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞—è –∫–Ω–∏–≥–∞ –∏—Å—Ç–æ—Ä–∏–∏, –≥–¥–µ –∫–∞–∂–¥—ã–π —à—Ç—Ä–∏—Ö —Å–∫—É–ª –∏ –∏–∑–≥–∏–± –Ω–æ—Å–∞ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ –≤–µ–ª–∏–∫–∏—Ö –º–∏–≥—Ä–∞—Ü–∏—è—Ö –∏ —Å–ª–∏—è–Ω–∏–∏ –º–∏—Ä–æ–≤.¬ª
            </p>
            <div class="mt-12 text-[10px] uppercase font-bold tracking-[1em]">Anthropology & History Project 2024</div>
        </div>
    </footer>

    <script>
        const translations = {
            ru: {
                title: "–ê–Ω—Ç—Ä–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ–±–ª–∏–∫ –¥—Ä–µ–≤–Ω–∏—Ö –∂–∏—Ç–µ–ª–µ–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞",
                vizTitle: "–õ–∏—Ü–æ —Å–∫–≤–æ–∑—å –≤—Ä–µ–º—è",
                vizDesc: "–£–∑–Ω–∞–π—Ç–µ, –∫–∞–∫ —É—á–µ–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –æ–±–ª–∏–∫ –ø—Ä–µ–¥–∫–æ–≤ –ø–æ —á–µ—Ä–µ–ø—É —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –ú. –ì–µ—Ä–∞—Å–∏–º–æ–≤–∞. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —ç—Ç–∞–ø—ã, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å.",
                badge: "–ú–µ—Ç–æ–¥ –ú. –ì–µ—Ä–∞—Å–∏–º–æ–≤–∞",
                layerTitle: { skull: "–û—Å–Ω–æ–≤–∞: –ß–µ—Ä–µ–ø", muscles: "–í—Ç–æ—Ä–æ–π —ç—Ç–∞–ø: –ú—ã—à—Ü—ã", final: "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ: –û–±–ª–∏–∫" },
                layerDesc: { 
                    skull: "–ß–µ—Ä–µ–ø ‚Äî —ç—Ç–æ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç. –ï–≥–æ —Ä–∞–∑–º–µ—Ä—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –ø–æ—Å–∞–¥–∫—É –≥–ª–∞–∑, —Ñ–æ—Ä–º—É –Ω–æ—Å–∞ –∏ —à–∏—Ä–∏–Ω—É —Å–∫—É–ª.", 
                    muscles: "–ù–∞–Ω–µ—Å–µ–Ω–∏–µ –º—è–≥–∫–∏—Ö —Ç–∫–∞–Ω–µ–π –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º –º–∞—Ä–∫–µ—Ä–∞–º —Ç–æ–ª—â–∏–Ω—ã. –ì–µ—Ä–∞—Å–∏–º–æ–≤ –≤—ã—è–≤–∏–ª –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ —Å–≤—è–∑–∏ –∫–æ—Å—Ç–∏ –∏ –ø–ª–æ—Ç–∏.", 
                    final: "–ö–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–∂–∏, –≤–æ–ª–æ—Å –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö —á–µ—Ä—Ç, –ø—Ä–∏—Å—É—â–∏—Ö —ç–ø–æ—Ö–µ –∏ –∫—É–ª—å—Ç—É—Ä–µ." 
                },
                planTitle: "–≠–≤–æ–ª—é—Ü–∏—è —Ç–∏–ø–æ–≤",
                era1T: "–≠–ø–æ—Ö–∞ –±—Ä–æ–Ω–∑—ã", era1D: "–Ø—Ä–∫–∏–µ –µ–≤—Ä–æ–ø–µ–æ–∏–¥–Ω—ã–µ —á–µ—Ä—Ç—ã: –≤—ã—Å–æ–∫–æ–µ –ª–∏—Ü–æ, —Å–∏–ª—å–Ω–æ –≤—ã—Å—Ç—É–ø–∞—é—â–∏–π –Ω–æ—Å, –º–∞—Å—Å–∏–≤–Ω–æ–µ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ (–ê–Ω–¥—Ä–æ–Ω–æ–≤—Å–∫–∞—è –∫—É–ª—å—Ç—É—Ä–∞).",
                era2T: "–†–∞–Ω–Ω–µ–µ –∂–µ–ª–µ–∑–æ", era2D: "–ù–∞—á–∞–ª–æ –º–µ—Ç–∏—Å–∞—Ü–∏–∏. –£ —Å–∞–∫–æ–≤ –ø–æ—è–≤–ª—è—é—Ç—Å—è –º–æ–Ω–≥–æ–ª–æ–∏–¥–Ω—ã–µ —á–µ—Ä—Ç—ã –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –µ–≤—Ä–æ–ø–µ–æ–∏–¥–Ω–æ–≥–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞.",
                era3T: "–≠–ø–æ—Ö–∞ –ì—É–Ω–Ω–æ–≤", era3D: "–ü—Ä–∏—Ç–æ–∫ –ø–ª–µ–º–µ–Ω –∏–∑ –≥–ª—É–±–∏–Ω –ê–∑–∏–∏ —É—Å–∏–ª–∏–≤–∞–µ—Ç –º–æ–Ω–≥–æ–ª–æ–∏–¥–Ω–æ—Å—Ç—å. –õ–∏—Ü–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª–µ–µ –ø–ª–æ—Å–∫–∏–º, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –±—Ä–∞—Ö–∏–∫–µ—Ñ–∞–ª–∏—è.",
                featTitle: "–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–¥ –Ω–∞—Ü–∏–∏",
                featDesc: "–ê–Ω—Ç—Ä–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ–±–ª–∏–∫ –∫–∞–∑–∞—Ö–æ–≤ ‚Äî —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç—ã—Å—è—á–µ–ª–µ—Ç–Ω–∏—Ö –≤—Å—Ç—Ä–µ—á –í–æ—Å—Ç–æ–∫–∞ –∏ –ó–∞–ø–∞–¥–∞ –≤ —Å–µ—Ä–¥—Ü–µ –ï–≤—Ä–∞–∑–∏–∏.",
                sci1T: "–ö—Ä–∞–Ω–∏–æ–º–µ—Ç—Ä–∏—è", sci1D: "–¢–æ—á–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è —á–µ—Ä–µ–ø–∞ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ä–∞—Å–æ–≤—ã—Ö –∏ —ç—Ç–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–∞–∑–ª–∏—á–∏–π.",
                sci2T: "–û–¥–æ–Ω—Ç–æ–ª–æ–≥–∏—è", sci2D: "–ê–Ω–∞–ª–∏–∑ –∑—É–±–æ–≤ ‚Äî –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –Ω–∞–¥–µ–∂–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–∫–æ–≤.",
                footer: "¬´–õ–∏—Ü–∞ –¥—Ä–µ–≤–Ω–∏—Ö –∂–∏—Ç–µ–ª–µ–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ ‚Äî —ç—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞—è –∫–Ω–∏–≥–∞ –∏—Å—Ç–æ—Ä–∏–∏, –≥–¥–µ –∫–∞–∂–¥—ã–π —à—Ç—Ä–∏—Ö —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ —Å–ª–∏—è–Ω–∏–∏ –º–∏—Ä–æ–≤.¬ª"
            },
            kz: {
                title: "“ö–∞–∑–∞“õ—Å—Ç–∞–Ω–Ω—ã“£ –µ–∂–µ–ª–≥—ñ —Ç“±—Ä“ì—ã–Ω–¥–∞—Ä—ã–Ω—ã“£ –∞–Ω—Ç—Ä–æ–ø–æ–ª–æ–≥–∏—è–ª—ã“õ –∫–µ–ª–±–µ—Ç—ñ",
                vizTitle: "–£–∞“õ—ã—Ç –±–µ–π–Ω–µ—Å—ñ",
                vizDesc: "–ú. –ì–µ—Ä–∞—Å–∏–º–æ–≤ ”ô–¥—ñ—Å—ñ –∞—Ä“õ—ã–ª—ã –±–∞—Å —Å“Ø–π–µ–∫ –±–æ–π—ã–Ω—à–∞ –µ–∂–µ–ª–≥—ñ –∞—Ç–∞-–±–∞–±–∞–ª–∞—Ä–¥—ã“£ –∫–µ–ª–±–µ—Ç—ñ–Ω “õ–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É –∂–æ–ª—ã–Ω –∑–µ—Ä—Ç—Ç–µ“£—ñ–∑.",
                badge: "–ú. –ì–µ—Ä–∞—Å–∏–º–æ–≤ ”ô–¥—ñ—Å—ñ",
                layerTitle: { skull: "–ù–µ–≥—ñ–∑: –ë–∞—Å —Å“Ø–π–µ–∫", muscles: "–ï–∫—ñ–Ω—à—ñ –∫–µ–∑–µ“£: –ë“±–ª—à—ã“õ–µ—Ç", final: "–ê—è“õ—Ç–∞–ª—É: –ö–µ–ª–±–µ—Ç" },
                layerDesc: { 
                    skull: "–ë–∞—Å —Å“Ø–π–µ–∫ ‚Äî –±“±–ª –±–∏–æ–ª–æ–≥–∏—è–ª—ã“õ –ø–∞—Å–ø–æ—Ä—Ç. –û–Ω—ã“£ ”©–ª—à–µ–º–¥–µ—Ä—ñ –∫”©–∑–¥—ñ“£ –æ—Ä–Ω–∞–ª–∞—Å—É—ã–Ω, –º“±—Ä—ã–Ω –ø—ñ—à—ñ–Ω—ñ–Ω –∞–Ω—ã“õ—Ç–∞–π–¥—ã.", 
                    muscles: "–ñ“±–º—Å–∞“õ —Ç—ñ–Ω–¥–µ—Ä–¥—ñ “õ–∞–ª—ã“£–¥—ã“õ –º–∞—Ä–∫–µ—Ä–ª–µ—Ä—ñ –±–æ–π—ã–Ω—à–∞ —Å–∞–ª—É. –°“Ø–π–µ–∫ –ø–µ–Ω —Ç—ñ–Ω–Ω—ñ“£ –±–∞–π–ª–∞–Ω—ã—Å –∑–∞“£–¥—ã–ª—ã“õ—Ç–∞—Ä—ã –µ—Å–∫–µ—Ä—ñ–ª–µ–¥—ñ.", 
                    final: "–°–æ“£“ì—ã –Ω”ô—Ç–∏–∂–µ: —Ç–µ—Ä—ñ, —à–∞—à –∂”ô–Ω–µ –¥”ô—É—ñ—Ä–≥–µ —Ç”ô–Ω –µ—Ä–µ–∫—à–µ –±–µ–ª–≥—ñ–ª–µ—Ä–¥—ñ “õ–æ—Å—É –∞—Ä“õ—ã–ª—ã –±–µ–π–Ω–µ–Ω—ñ “õ–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É." 
                },
                planTitle: "–¢–∏–ø—Ç–µ—Ä–¥—ñ“£ —ç–≤–æ–ª—é—Ü–∏—è—Å—ã",
                era1T: "“ö–æ–ª–∞ –¥”ô—É—ñ—Ä—ñ", era1D: "–ê–π“õ—ã–Ω –µ—É—Ä–æ–ø–µ–æ–∏–¥—Ç—ã“õ –±–µ–ª–≥—ñ–ª–µ—Ä: –±–∏—ñ–∫ –±–µ—Ç, “õ–∞—Ç—Ç—ã —à—ã“ì—ã“£“õ—ã –º“±—Ä—ã–Ω, —ñ—Ä—ñ –¥–µ–Ω–µ –±—ñ—Ç—ñ–º—ñ (–ê–Ω–¥—Ä–æ–Ω–æ–≤ –º”ô–¥–µ–Ω–∏–µ—Ç—ñ).",
                era2T: "–ï—Ä—Ç–µ —Ç–µ–º—ñ—Ä", era2D: "–ú–µ—Ç–∏—Å–∞—Ü–∏—è–Ω—ã“£ –±–∞—Å—Ç–∞–ª—É—ã. –°–∞“õ—Ç–∞—Ä–¥–∞ –µ—É—Ä–æ–ø–µ–æ–∏–¥—Ç—ã“õ –Ω–µ–≥—ñ–∑ —Å–∞“õ—Ç–∞–ª–∞ –æ—Ç—ã—Ä—ã–ø, –º–æ–Ω–≥–æ–ª–æ–∏–¥—Ç—ã“õ –±–µ–ª–≥—ñ–ª–µ—Ä –ø–∞–π–¥–∞ –±–æ–ª–∞ –±–∞—Å—Ç–∞–π–¥—ã.",
                era3T: "“í“±–Ω–¥–∞—Ä –¥”ô—É—ñ—Ä—ñ", era3D: "–ê–∑–∏—è —Ç–µ—Ä–µ“£—ñ–Ω–µ–Ω –∫–µ–ª–≥–µ–Ω —Ç–∞–π–ø–∞–ª–∞—Ä –º–æ–Ω–≥–æ–ª–æ–∏–¥—Ç—ã“õ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—Ç—ñ –∫“Ø—à–µ–π—Ç–µ–¥—ñ. –ë–µ—Ç –∂–∞–∑—ã“õ—Ç–∞–ª—ã–ø, –±—Ä–∞—Ö–∏–∫–µ—Ñ–∞–ª–∏—è –¥–∞–º–∏–¥—ã.",
                featTitle: "“∞–ª—Ç—Ç—ã“£ –≥–µ–Ω–µ—Ç–∏–∫–∞–ª—ã“õ –∫–æ–¥—ã",
                featDesc: "“ö–∞–∑–∞“õ—Ç–∞—Ä–¥—ã“£ –∞–Ω—Ç—Ä–æ–ø–æ–ª–æ–≥–∏—è–ª—ã“õ –∫–µ–ª–±–µ—Ç—ñ ‚Äî –ï—É—Ä–∞–∑–∏—è —Ç”©—Ä—ñ–Ω–¥–µ–≥—ñ –®—ã“ì—ã—Å –ø–µ–Ω –ë–∞—Ç—ã—Å—Ç—ã“£ –º—ã“£–∂—ã–ª–¥—ã“õ —Ç–æ“ì—ã—Å—É—ã–Ω—ã“£ –±—ñ—Ä–µ–≥–µ–π –Ω”ô—Ç–∏–∂–µ—Å—ñ.",
                sci1T: "–ö—Ä–∞–Ω–∏–æ–º–µ—Ç—Ä–∏—è", sci1D: "–ù”ô—Å—ñ–ª–¥—ñ–∫ –∂”ô–Ω–µ —ç—Ç–Ω–∏–∫–∞–ª—ã“õ –∞–π—ã—Ä–º–∞—à—ã–ª—ã“õ—Ç–∞—Ä–¥—ã –∞–Ω—ã“õ—Ç–∞—É “Ø—à—ñ–Ω –±–∞—Å —Å“Ø–π–µ–∫—Ç—ñ –¥”ô–ª ”©–ª—à–µ—É.",
                sci2T: "–û–¥–æ–Ω—Ç–æ–ª–æ–≥–∏—è", sci2D: "–¢—ñ—Å—Ç–µ—Ä–¥—ñ —Ç–∞–ª–¥–∞—É ‚Äî –∞—Ç–∞-–±–∞–±–∞ –º–∏–≥—Ä–∞—Ü–∏—è—Å—ã–Ω “õ–∞–¥–∞“ì–∞–ª–∞—É–¥—ã“£ –µ“£ —Å–µ–Ω—ñ–º–¥—ñ —Ç”ô—Å—ñ–ª–¥–µ—Ä—ñ–Ω—ñ“£ –±—ñ—Ä—ñ.",
                footer: "¬´“ö–∞–∑–∞“õ—Å—Ç–∞–Ω–Ω—ã“£ –µ–∂–µ–ª–≥—ñ —Ç“±—Ä“ì—ã–Ω–¥–∞—Ä—ã–Ω—ã“£ –∂“Ø–∑–¥–µ—Ä—ñ ‚Äî ”ô–ª–µ–º–¥–µ—Ä–¥—ñ“£ —Ç–æ“ì—ã—Å—É—ã–Ω –±–∞—è–Ω–¥–∞–π—Ç—ã–Ω —Ç–∞—Ä–∏—Ö—Ç—ã“£ –∞—à—ã“õ –∫—ñ—Ç–∞–±—ã.¬ª"
            },
            en: {
                title: "Anthropological Appearance of Ancient Kazakhstan Residents",
                vizTitle: "Face Through Time",
                vizDesc: "Discover how scientists restore ancestors' looks using M. Gerasimov's facial reconstruction method. Click stages to see progress.",
                badge: "M. Gerasimov Method",
                layerTitle: { skull: "Foundation: Skull", muscles: "Phase Two: Muscles", final: "Completion: Portrait" },
                layerDesc: { 
                    skull: "The skull is a biological passport. Its dimensions determine eye placement, nose shape, and cheekbone width.", 
                    muscles: "Applying soft tissues using thickness markers. Gerasimov identified patterns linking bone and flesh.", 
                    final: "Final result: adding skin, hair, and specific features characteristic of the era and culture." 
                },
                planTitle: "Evolution of Types",
                era1T: "Bronze Age", era1D: "Clear Caucasoid features: high face, prominent nose, massive build (Andronovo culture).",
                era2T: "Early Iron Age", era2D: "Start of mestization. Saka tribes show early Mongoloid traits while maintaining a Caucasoid foundation.",
                era3T: "Hunnic Era", era3D: "Tribes from deep Asia increase the Mongoloid component. Faces flatten, and brachycephaly emerges.",
                featTitle: "National Genetic Code",
                featDesc: "The anthropological appearance of Kazakhs is a unique result of a millennia-long encounter between East and West.",
                sci1T: "Craniometry", sci1D: "Precise skull measurements to identify racial and ethnic differences.",
                sci2T: "Odontology", sci2D: "Dental analysis is one of the most reliable ways to track ancestral migrations.",
                footer: "¬´The faces of ancient Kazakhstan residents are an open book of history, where every trait tells of merging worlds.¬ª"
            }
        };

        let currentLang = 'ru';
        const canvas = document.getElementById('faceCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth;
            canvas.height = 500;
            drawLayer('skull');
        }

        function drawLayer(layer) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;
            const scale = canvas.height / 600;

            // Reset buttons
            ['skull', 'muscles', 'final'].forEach(l => {
                document.getElementById(`step-${l}`).className = "process-btn px-6 py-2 rounded-full text-xs font-bold uppercase";
            });
            document.getElementById(`step-${layer}`).className = "process-btn active px-6 py-2 rounded-full text-xs font-bold uppercase";

            // Update text panel
            document.getElementById('layer-title').innerText = translations[currentLang].layerTitle[layer];
            document.getElementById('layer-desc').innerText = translations[currentLang].layerDesc[layer];

            // Canvas Drawing Logic (Abstract representation)
            ctx.lineWidth = 3;
            
            // 1. Skull Layer (Always as base)
            ctx.beginPath();
            ctx.ellipse(cx, cy - 20*scale, 100*scale, 130*scale, 0, 0, Math.PI * 2);
            ctx.strokeStyle = layer === 'skull' ? '#2d2a28' : '#d1ccc0';
            ctx.stroke();
            // Jaw
            ctx.beginPath();
            ctx.moveTo(cx - 70*scale, cy + 50*scale);
            ctx.quadraticCurveTo(cx, cy + 150*scale, cx + 70*scale, cy + 50*scale);
            ctx.stroke();

            if (layer === 'muscles' || layer === 'final') {
                // 2. Muscles / Flesh outlines
                ctx.beginPath();
                ctx.ellipse(cx, cy - 20*scale, 115*scale, 145*scale, 0, 0, Math.PI * 2);
                ctx.strokeStyle = layer === 'muscles' ? '#2d2a28' : '#d1ccc0';
                ctx.stroke();
                // Nose line
                ctx.beginPath();
                ctx.moveTo(cx, cy - 40*scale);
                ctx.lineTo(cx, cy + 20*scale);
                ctx.stroke();
            }

            if (layer === 'final') {
                // 3. Final Skin & Hair
                ctx.fillStyle = 'rgba(45, 42, 40, 0.1)';
                ctx.beginPath();
                ctx.ellipse(cx, cy - 20*scale, 120*scale, 150*scale, 0, 0, Math.PI * 2);
                ctx.fill();
                // Hair line
                ctx.beginPath();
                ctx.moveTo(cx - 120*scale, cy - 50*scale);
                ctx.quadraticCurveTo(cx, cy - 200*scale, cx + 120*scale, cy - 50*scale);
                ctx.strokeStyle = '#2d2a28';
                ctx.stroke();
            }
            
            // Marker Points (Lab look)
            ctx.fillStyle = '#ef4444';
            [ {x:cx, y:cy-20*scale}, {x:cx-60*scale, y:cy}, {x:cx+60*scale, y:cy}, {x:cx, y:cy+100*scale} ].forEach(p => {
                ctx.beginPath();
                ctx.arc(p.x, p.y, 3, 0, Math.PI*2);
                ctx.fill();
            });
        }

        function setLang(lang) {
            currentLang = lang;
            const t = translations[lang];
            
            document.getElementById('main-title').innerText = t.title;
            document.getElementById('viz-title').innerText = t.vizTitle;
            document.getElementById('viz-desc').innerText = t.vizDesc;
            document.getElementById('badge').innerText = t.badge;
            document.getElementById('plan-title').innerText = t.planTitle;
            document.getElementById('era1-t').innerText = t.era1T; document.getElementById('era1-d').innerText = t.era1D;
            document.getElementById('era2-t').innerText = t.era2T; document.getElementById('era2-d').innerText = t.era2D;
            document.getElementById('era3-t').innerText = t.era3T; document.getElementById('era3-d').innerText = t.era3D;
            document.getElementById('feat-title').innerText = t.featTitle;
            document.getElementById('feat-desc').innerText = t.featDesc;
            document.getElementById('sci-1-t').innerText = t.sci1T; document.getElementById('sci-1-d').innerText = t.sci1D;
            document.getElementById('sci-2-t').innerText = t.sci2T; document.getElementById('sci-2-d').innerText = t.sci2D;
            document.getElementById('footer-text').innerText = t.footer;

            ['ru', 'kz', 'en'].forEach(l => {
                const btn = document.getElementById(`btn-${l}`);
                btn.className = l === lang ? "px-6 py-2 rounded-lg text-sm font-black lang-active" : "px-6 py-2 rounded-lg text-sm font-bold text-stone-500 hover:text-stone-800 transition-all";
            });

            drawLayer('skull');
        }

        window.addEventListener('resize', resizeCanvas);
        window.onload = () => {
            resizeCanvas();
            setLang('ru');
        }
    </script>

<script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
<script>
    function goBack() {
        console.log('goBack() –≤—ã–∑–≤–∞–Ω–∞');
        if (typeof bridge !== 'undefined' && bridge) {
            console.log('Bridge –Ω–∞–π–¥–µ–Ω, –≤—ã–∑—ã–≤–∞—é onBackClicked()');
            bridge.onBackClicked();
        } else {
            console.log('Bridge –Ω–µ –Ω–∞–π–¥–µ–Ω!');
        }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è QWebChannel
    document.addEventListener('DOMContentLoaded', function() {
        console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è QWebChannel...');

        if (typeof QWebChannel !== 'undefined' && typeof qt !== 'undefined') {
            try {
                new QWebChannel(qt.webChannelTransport, function(channel) {
                    window.bridge = channel.objects.bridge;
                    console.log('‚úÖ Bridge –ø–æ–¥–∫–ª—é—á–µ–Ω!');
                });
            } catch(e) {
                console.error('‚ùå QWebChannel –æ—à–∏–±–∫–∞:', e);
            }
        } else {
            console.warn('‚ö†Ô∏è QWebChannel –∏–ª–∏ qt –Ω–µ –Ω–∞–π–¥–µ–Ω');
        }
    });
</script>






<style data-oi-map-overlay>
.oi-map-btn{
  position:fixed; right:16px; bottom:16px; z-index:9999;
  padding:10px 14px; border-radius:999px; border:1px solid rgba(0,0,0,.15);
  background:#fff; cursor:pointer; font:600 14px/1.1 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  box-shadow:0 8px 20px rgba(0,0,0,.12);
}
.oi-map-backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.72); z-index:10000;
  display:none; align-items:center; justify-content:center; padding:18px;
}
.oi-map-backdrop[aria-hidden="false"]{ display:flex; }
.oi-map-modal{
  width:min(1100px, 100%); height:min(85vh, 900px);
  background:#111; border-radius:14px; overflow:hidden; position:relative;
  box-shadow:0 20px 60px rgba(0,0,0,.35);
}
.oi-map-close{
  position:absolute; top:10px; right:10px; z-index:3;
  width:40px; height:40px; border-radius:999px; border:1px solid rgba(255,255,255,.25);
  background:rgba(0,0,0,.35); color:#fff; cursor:pointer; font-size:22px;
}
.oi-map-viewport{
  width:100%; height:100%; overflow:auto; -webkit-overflow-scrolling:touch;
  touch-action: pan-x pan-y;
  background:#000;
  padding-top:56px; /* –º–µ—Å—Ç–æ –ø–æ–¥ —Ç—É–ª–±–∞—Ä */
}
.oi-map-img{
  display:block;
  transform-origin: 0 0;
  user-select:none; -webkit-user-drag:none;
}
.oi-map-toolbar{
  position:absolute; left:12px; top:12px; right:12px; z-index:2;
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  pointer-events:none;
}
.oi-map-tabs{ display:flex; gap:8px; pointer-events:auto; }
.oi-map-tab{
  width:36px; height:34px; border-radius:10px;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(0,0,0,.35); color:#fff;
  cursor:pointer; font:600 14px system-ui,-apple-system,Segoe UI,Roboto,Arial;
}
.oi-map-tab.is-active{
  background:rgba(255,255,255,.12);
  border-color: rgba(255,255,255,.45);
}
.oi-map-hint{
  pointer-events:none;
  color:#fff; opacity:.85; font:12px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.18);
  padding:8px 10px; border-radius:10px;
}
</style>

<button class="oi-map-btn" type="button" data-oi-map-btn>üó∫Ô∏è –ö–∞—Ä—Ç–∞</button>

<div class="oi-map-backdrop" aria-hidden="true" data-oi-map-backdrop>
  <div class="oi-map-modal" role="dialog" aria-modal="true" aria-label="–ö–∞—Ä—Ç–∞">
    <button class="oi-map-close" type="button" aria-label="–ó–∞–∫—Ä—ã—Ç—å" data-oi-map-close>√ó</button>

    <div class="oi-map-toolbar">
      <div class="oi-map-tabs">
        <button type="button" class="oi-map-tab is-active" data-oi-map-tab="1">1</button>
        <button type="button" class="oi-map-tab" data-oi-map-tab="2">2</button>
        <button type="button" class="oi-map-tab" data-oi-map-tab="3">3</button>
        <button type="button" class="oi-map-tab" data-oi-map-tab="4">4</button>
      </div>
      <div class="oi-map-hint">–ö–æ–ª—ë—Å–∏–∫–æ/—Ç—Ä–µ–∫–ø–∞–¥ ‚Äî –∑—É–º ‚Ä¢ Esc ‚Äî –∑–∞–∫—Ä—ã—Ç—å</div>
    </div>

    <div class="oi-map-viewport" data-oi-map-viewport>
      <img class="oi-map-img" data-oi-map-img data-map="1" src="../../assets/maps/karta_1.png" alt="–ö–∞—Ä—Ç–∞ 1" style="display:block;">
<img class="oi-map-img" data-oi-map-img data-map="2" src="../../assets/maps/karta_2.png" alt="–ö–∞—Ä—Ç–∞ 2" style="display:none;">
<img class="oi-map-img" data-oi-map-img data-map="3" src="../../assets/maps/karta_3.png" alt="–ö–∞—Ä—Ç–∞ 3" style="display:none;">
<img class="oi-map-img" data-oi-map-img data-map="4" src="../../assets/maps/karta_4.png" alt="–ö–∞—Ä—Ç–∞ 4" style="display:none;">
    </div>
  </div>
</div>


<script data-oi-map-overlay>
(function(){
  const btn = document.querySelector('[data-oi-map-btn]');
  const backdrop = document.querySelector('[data-oi-map-backdrop]');
  const closeBtn = document.querySelector('[data-oi-map-close]');
  const viewport = document.querySelector('[data-oi-map-viewport]');
  const tabs = Array.from(document.querySelectorAll('[data-oi-map-tab]'));
  const imgs = Array.from(document.querySelectorAll('[data-oi-map-img][data-map]'));
  if(!btn || !backdrop || !closeBtn || !viewport || imgs.length === 0) return;

  let scale = 1;

  function applyScale(){
    imgs.forEach(img => { img.style.transform = `scale(${scale})`; });
  }
  function openMap(){
    backdrop.setAttribute('aria-hidden','false');
    document.body.style.overflow = 'hidden';
  }
  function closeMap(){
    backdrop.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }
  function showMap(n){
    imgs.forEach(img => {
      img.style.display = (img.getAttribute('data-map') === String(n)) ? 'block' : 'none';
    });
    tabs.forEach(t => t.classList.toggle('is-active', t.getAttribute('data-oi-map-tab') === String(n)));
    viewport.scrollTop = 0;
    viewport.scrollLeft = 0;
  }

  btn.addEventListener('click', openMap);
  closeBtn.addEventListener('click', closeMap);
  backdrop.addEventListener('click', (e)=>{ if(e.target === backdrop) closeMap(); });
  window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeMap(); });

  tabs.forEach(t => t.addEventListener('click', () => showMap(t.getAttribute('data-oi-map-tab'))));

  viewport.addEventListener('wheel', (e)=>{
    if(backdrop.getAttribute('aria-hidden') !== 'false') return;
    e.preventDefault();
    const delta = -Math.sign(e.deltaY) * 0.1;
    scale = Math.min(4, Math.max(0.6, scale + delta));
    applyScale();
  }, {passive:false});

  applyScale();
  showMap(1);
})();
</script>
</body>
</html>