<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ –ö–∞—Ä–∞—Ö–∞–Ω–∏–¥–æ–≤ (942‚Äì1212 –≥–≥.)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Inter:wght@300;400;600&display=swap&subset=cyrillic,cyrillic-ext" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fdfaf6; color: #451a03; }
        h1, h2, h3 { font-family: 'Montserrat', sans-serif; }

        .terracotta-gradient {
            background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 50%, #fed7aa 100%);
        }

        .islamic-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border-radius: 3rem;
            border: 2px solid #92400e;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .islamic-panel:hover {
            border-color: #b45309;
            box-shadow: 0 25px 60px -15px rgba(146, 64, 14, 0.2);
        }

        .lang-active {
            background-color: #92400e;
            color: #ffffff;
            box-shadow: 0 10px 15px -3px rgba(146, 64, 14, 0.3);
        }

        canvas {
            cursor: pointer;
            filter: drop-shadow(0 15px 30px rgba(146, 64, 14, 0.1));
            border-radius: 2rem;
        }

        .info-card {
            background: white;
            border-radius: 2.5rem;
            border: 1px solid #fed7aa;
            padding: 2.5rem;
            transition: all 0.3s ease;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .info-card::before {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 6px;
            background: #92400e;
        }

        .info-card:hover {
            transform: translateY(-8px);
            border-color: #d97706;
        }

        .ornament-bg {
            background-image: url("https://www.transparenttextures.com/patterns/arabesque.png");
        }

        .term-badge {
            background: #fef3c7;
            color: #92400e;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 900;
            text-transform: uppercase;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body class="terracotta-gradient min-h-screen pb-20 ornament-bg">

<!-- Header (No emoji) -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-orange-200 px-6 py-5">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6">
            <h1 id="main-title" class="text-xl md:text-2xl font-black uppercase tracking-[0.25em] text-orange-900 text-center">–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ –ö–∞—Ä–∞—Ö–∞–Ω–∏–¥–æ–≤ (942‚Äì1212 –≥–≥.)</h1>
            <div class="flex bg-orange-100 p-1 rounded-xl border border-orange-200">
                <button onclick="setLang('ru')" id="btn-ru" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">RU</button>
                <button onclick="setLang('kz')" id="btn-kz" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">KZ</button>
                <button onclick="setLang('en')" id="btn-en" class="px-6 py-2 rounded-lg text-sm font-bold transition-all">EN</button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-12 space-y-16">
        
        <!-- Section 1: Interactive Architecture Explorer (Canvas) -->
        <div class="islamic-panel p-8 md:p-12">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-12 items-center">
                <div class="lg:col-span-4 space-y-8">
                    <div id="badge" class="inline-block bg-amber-800 text-white px-5 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest">Architectural Heritage Analysis</div>
                    <h2 id="viz-title" class="text-3xl md:text-4xl font-black text-amber-950 leading-tight uppercase italic">–ö–æ–¥ –¢–µ—Ä—Ä–∞–∫–æ—Ç—ã: –ú–∞–≤–∑–æ–ª–µ–π</h2>
                    <p id="viz-desc" class="text-lg text-amber-900/60 font-light leading-relaxed">
                        –ö–∞—Ä–∞—Ö–∞–Ω–∏–¥—ã –ø—Ä–∏–≤–Ω–µ—Å–ª–∏ –≤ —Å—Ç–µ–ø—å –∫—É–ª—å—Ç—É—Ä—É –∫–∏—Ä–ø–∏—á–Ω–æ–≥–æ –∑–æ–¥—á–µ—Å—Ç–≤–∞ –∏ —Å–ª–æ–∂–Ω–æ–≥–æ –æ—Ä–Ω–∞–º–µ–Ω—Ç–∞. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —á–∞—Å—Ç–∏ —Ñ–∞—Å–∞–¥–∞, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –¥—Ä–µ–≤–Ω–∏—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–π.
                    </p>
                    
                    <div id="info-panel" class="p-8 rounded-[2.5rem] bg-amber-50 border-l-8 border-amber-700 shadow-xl transition-all duration-500">
                        <h3 id="element-title" class="text-xl font-bold text-amber-900 mb-3 uppercase tracking-tighter">–ù–∞—á–Ω–∏—Ç–µ –∞–Ω–∞–ª–∏–∑</h3>
                        <p id="element-desc" class="text-amber-800/70 text-sm leading-relaxed italic">–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫—É–ø–æ–ª, –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–ª–∏—Ç–∫—É –∏–ª–∏ –ø–æ—Ä—Ç–∞–ª—å–Ω—É—é –∞—Ä–∫—É.</p>
                    </div>
                </div>
                
                <div class="lg:col-span-8 bg-white/50 p-4 rounded-[4rem] flex items-center justify-center relative min-h-[550px] border border-orange-200">
                    <canvas id="archCanvas"></canvas>
                    <div class="absolute bottom-8 right-12 text-[10px] text-amber-800/30 font-mono uppercase tracking-[0.3em]">Karakhanid Architectural Blueprint</div>
                </div>
            </div>
        </div>

        <!-- Section 2: Detailed History Blocks -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            
            <!-- Islam and State -->
            <div class="info-card">
                <div class="mb-6"><span class="term-badge" id="t-rel">–†–µ–ª–∏–≥–∏—è</span></div>
                <h3 id="c1-t" class="text-xl font-bold mb-4 uppercase text-amber-900">960 –≥. –ò—Å–ª–∞–º—Å–∫–∞—è –†–µ–≤–æ–ª—é—Ü–∏—è</h3>
                <p id="c1-d" class="text-stone-600 text-sm leading-relaxed">
                    –í **960 –≥–æ–¥—É** –ø—Ä–∏ –ø—Ä–∞–≤–∏—Ç–µ–ª–µ **–ú—É—Å–∞-–∫–∞–≥–∞–Ω–µ** –∏—Å–ª–∞–º –±—ã–ª –æ–±—ä—è–≤–ª–µ–Ω –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–ª–∏–≥–∏–µ–π. –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ–±—ä–µ–¥–∏–Ω–∏–ª–æ 200 —Ç—ã—Å—è—á —à–∞—Ç—Ä–æ–≤ –∫–æ—á–µ–≤–Ω–∏–∫–æ–≤ –∏ –æ—Ç–∫—Ä—ã–ª–æ –¥–æ—Å—Ç—É–ø –∫ –∑–Ω–∞–Ω–∏—è–º –•–∞–ª–∏—Ñ–∞—Ç–∞. –û—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–º –¥–∏–Ω–∞—Å—Ç–∏–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è **–°–∞—Ç—É–∫ –ë–æ–≥—Ä–∞-—Ö–∞–Ω**, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–≤—ã–º –∏–∑ —Ç—é—Ä–∫—Å–∫–∏—Ö –ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π –ø—Ä–∏–Ω—è–ª –∏—Å–ª–∞–º.
                </p>
                <div class="mt-6 pt-4 border-t border-orange-100 text-[11px] font-bold text-amber-800 uppercase tracking-wider" id="c1-f">
                    –≠—Ñ—Ñ–µ–∫—Ç: –†–æ—Å—Ç –≥–æ—Ä–æ–¥–æ–≤ –∏ –ø–∏—Å—å–º–µ–Ω–Ω–æ—Å—Ç–∏.
                </div>
            </div>

            <!-- Socio-Economic System -->
            <div class="info-card">
                <div class="mb-6"><span class="term-badge" id="t-soc">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</span></div>
                <h3 id="c2-t" class="text-xl font-bold mb-4 uppercase text-amber-900">–°–∏—Å—Ç–µ–º–∞ –ò–∫—Ç–∞</h3>
                <p id="c2-d" class="text-stone-600 text-sm leading-relaxed">
                    –ö–∞—Ä–∞—Ö–∞–Ω–∏–¥—ã –≤–≤–µ–ª–∏ —Ñ–µ–æ–¥–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É **–ò–∫—Ç–∞** ‚Äî –ø—Ä–∞–≤–æ —Å–±–æ—Ä–∞ –Ω–∞–ª–æ–≥–æ–≤ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –º–µ—Å—Ç–Ω–æ—Å—Ç–∏, –¥–∞—Ä—É–µ–º–æ–µ –∫–∞–≥–∞–Ω–æ–º –∑–∞ –≤–æ–µ–Ω–Ω—É—é —Å–ª—É–∂–±—É. –î–µ—Ä–∂–∞—Ç–µ–ª—å –∏–∫—Ç–∞ (**–º—É–∫—Ç–∞**) –±—ã–ª –æ–±—è–∑–∞–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤–æ–π—Å–∫–æ. –¢–∞–∫–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ **–≤–∞–∫—Ñ—ã** ‚Äî –∑–µ–º–ª–∏ –º–µ—á–µ—Ç–µ–π –∏ –º–µ–¥—Ä–µ—Å–µ, –¥–æ—Ö–æ–¥—ã —Å –∫–æ—Ç–æ—Ä—ã—Ö —à–ª–∏ –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
                </p>
                <div class="mt-6 pt-4 border-t border-orange-100 text-[11px] font-bold text-amber-800 uppercase tracking-wider" id="c2-f">
                    –¢–∏—Ç—É–ª—ã: –¢–µ–≥–∏–Ω, –ò–ª–µ–∫-—Ö–∞–Ω, –ê—Ä—Å–ª–∞–Ω-—Ö–∞–Ω.
                </div>
            </div>

            <!-- Literature and Science -->
            <div class="info-card">
                <div class="mb-6"><span class="term-badge" id="t-sci">–ö—É–ª—å—Ç—É—Ä–∞</span></div>
                <h3 id="c3-t" class="text-xl font-bold mb-4 uppercase text-amber-900">–¢—é—Ä–∫—Å–∫–∏–π –†–µ–Ω–µ—Å—Å–∞–Ω—Å</h3>
                <p id="c3-d" class="text-stone-600 text-sm leading-relaxed">
                    –≠–ø–æ—Ö–∞ –ø–æ–¥–∞—Ä–∏–ª–∞ –º–∏—Ä—É –¥–≤—É—Ö —Ç–∏—Ç–∞–Ω–æ–≤ –º—ã—Å–ª–∏: **–Æ—Å—É—Ñ –ë–∞–ª–∞—Å–∞–≥—É–Ω–∏** –Ω–∞–ø–∏—Å–∞–ª —Ç—Ä–∞–∫—Ç–∞—Ç ¬´–ö—É—Ç–∞–¥–≥—É –ë–∏–ª–∏–≥¬ª (–ë–ª–∞–≥–æ–¥–∞—Ç–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ), –∞ **–ú–∞—Ö–º—É–¥ –ö–∞—à–≥–∞—Ä–∏** —Å–æ–∑–¥–∞–ª ¬´–î–∏–≤–∞–Ω –õ—É–≥–∞—Ç –∞—Ç-–¢—É—Ä–∫¬ª ‚Äî –ø–µ—Ä–≤—ã–π —Å–ª–æ–≤–∞—Ä—å —Ç—é—Ä–∫—Å–∫–∏—Ö –Ω–∞—Ä–µ—á–∏–π. –≠—Ç–∏ —Ç—Ä—É–¥—ã —Å—Ç–∞–ª–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º —Ç—é—Ä–∫—Å–∫–æ–π —Å–∞–º–æ–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã.
                </p>
                <div class="mt-6 pt-4 border-t border-orange-100 text-[11px] font-bold text-amber-800 uppercase tracking-wider" id="c3-f">
                    –°—Ç–æ–ª–∏—Ü—ã: –ë–∞–ª–∞—Å–∞–≥—É–Ω –∏ –ö–∞—à–≥–∞—Ä.
                </div>
            </div>

        </div>

        <!-- Section 3: Geopolitics Highlight -->
        <div class="bg-amber-900 p-10 md:p-20 rounded-[4rem] text-white shadow-2xl relative overflow-hidden">
            <div class="relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
                <div>
                    <h3 id="geo-t" class="text-4xl font-black mb-8 uppercase italic tracking-tighter">–†–∞—Å–∫–æ–ª –∏ –ü–∞–¥–µ–Ω–∏–µ</h3>
                    <p id="geo-d" class="text-amber-100/70 text-xl font-light leading-relaxed mb-8">
                        –í 1040 –≥–æ–¥—É –∫–∞–≥–∞–Ω–∞—Ç —Ä–∞—Å–ø–∞–ª—Å—è –Ω–∞ –ó–∞–ø–∞–¥–Ω—ã–π (—Ü–µ–Ω—Ç—Ä –≤ –°–∞–º–∞—Ä–∫–∞–Ω–¥–µ) –∏ –í–æ—Å—Ç–æ—á–Ω—ã–π (—Ü–µ–Ω—Ç—Ä –≤ –ë–∞–ª–∞—Å–∞–≥—É–Ω–µ). –í XII –≤–µ–∫–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ –æ—Å–ª–∞–±–ª–æ –ø–æ–¥ —É–¥–∞—Ä–∞–º–∏ **–∫–∞—Ä–∞–∫–∏—Ç–∞–µ–≤**, –∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–∫—Ä–∞—Ç–∏–ª–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤ 1212 –≥–æ–¥—É –ø–æ–¥ –Ω–∞—Ç–∏—Å–∫–æ–º **—Ö–æ—Ä–µ–∑–º—à–∞—Ö–∞ –ú—É—Ö–∞–º–º–µ–¥–∞**.
                    </p>
                    <div class="inline-flex items-center gap-4 bg-white/10 px-6 py-2 rounded-full border border-white/20">
                        <div class="w-3 h-3 bg-amber-500 rounded-full animate-ping"></div>
                        <span class="text-sm font-bold uppercase tracking-widest">–ö–æ–Ω–µ—Ü —ç–ø–æ—Ö–∏: 1212 –≥–æ–¥</span>
                    </div>
                </div>
                <div class="hidden lg:block relative">
                    <div class="w-full h-1 bg-white/20 absolute top-1/2 -translate-y-1/2 rounded-full"></div>
                    <div class="flex justify-between relative z-10">
                        <div class="text-center">
                            <div class="w-16 h-16 bg-amber-600 rounded-2xl flex items-center justify-center text-3xl mb-3 border-2 border-white/50">üè∞</div>
                            <div class="text-[10px] font-black uppercase">942 –≥.</div>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 bg-amber-700 rounded-2xl flex items-center justify-center text-3xl mb-3 border-2 border-white/50">‚öîÔ∏è</div>
                            <div class="text-[10px] font-black uppercase">1040 –≥.</div>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 bg-stone-800 rounded-2xl flex items-center justify-center text-3xl mb-3 border-2 border-white/50">üè≥Ô∏è</div>
                            <div class="text-[10px] font-black uppercase">1212 –≥.</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="absolute -bottom-20 -right-20 text-[25rem] opacity-5 font-black rotate-45 pointer-events-none uppercase">Empire</div>
        </div>

    </main>

    <footer class="mt-20 py-24 bg-stone-950 text-stone-500 text-center border-t border-amber-900/20">
        <div class="max-w-4xl mx-auto px-6">
            <p id="footer-text" class="text-2xl font-light italic text-stone-300">
                ¬´–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ –ö–∞—Ä–∞—Ö–∞–Ω–∏–¥–æ–≤ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–æ —Å—Ç–µ–ø–Ω–æ–π –¥—É—Ö –≤ –≤–µ—á–Ω—ã–µ –ø–∞–º—è—Ç–Ω–∏–∫–∏ –∏–∑ –∫–∞–º–Ω—è –∏ –∑–æ–ª–æ—Ç—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–µ–ª–∏–∫–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã.¬ª
            </p>
            <div class="mt-12 h-1 w-24 bg-amber-800 mx-auto rounded-full"></div>
        </div>
    </footer>

    <script>
        const translations = {
            ru: {
                title: "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ –ö–∞—Ä–∞—Ö–∞–Ω–∏–¥–æ–≤ (942‚Äì1212 –≥–≥.)",
                vizTitle: "–ö–æ–¥ –¢–µ—Ä—Ä–∞–∫–æ—Ç—ã: –ú–∞–≤–∑–æ–ª–µ–π",
                vizDesc: "–ó–æ–¥—á–µ—Å—Ç–≤–æ –ö–∞—Ä–∞—Ö–∞–Ω–∏–¥–æ–≤ ‚Äî —ç—Ç–æ —Å–∏–º–±–∏–æ–∑ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ—Ä—Ç–∞–ª–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –∏–Ω–Ω–æ–≤–∞—Ü–∏–π.",
                badge: "–ê–Ω–∞–ª–∏–∑ –∫—É–ª—å—Ç—É—Ä–Ω–æ–≥–æ –Ω–∞—Å–ª–µ–¥–∏—è",
                elementTitleDefault: "–ù–∞—á–Ω–∏—Ç–µ –∞–Ω–∞–ª–∏–∑",
                elementDescDefault: "–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫—É–ø–æ–ª, –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–ª–∏—Ç–∫—É –∏–ª–∏ –ø–æ—Ä—Ç–∞–ª—å–Ω—É—é –∞—Ä–∫—É.",
                tRel: "–†–µ–ª–∏–≥–∏—è", tSoc: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", tSci: "–ö—É–ª—å—Ç—É—Ä–∞",
                c1T: "960 –≥. –ò—Å–ª–∞–º—Å–∫–∞—è –†–µ–≤–æ–ª—é—Ü–∏—è", c1D: "–ü—Ä–∏ –ú—É—Å–∞-–∫–∞–≥–∞–Ω–µ –∏—Å–ª–∞–º —Å—Ç–∞–ª –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–ª–∏–≥–∏–µ–π. –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ–±—ä–µ–¥–∏–Ω–∏–ª–æ –∫–æ—á–µ–≤–Ω–∏–∫–æ–≤ –∏ –æ—Ç–∫—Ä—ã–ª–æ –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—É–∫–∞–º –•–∞–ª–∏—Ñ–∞—Ç–∞. –°–∞—Ç—É–∫ –ë–æ–≥—Ä–∞-—Ö–∞–Ω –∑–∞–ª–æ–∂–∏–ª –æ—Å–Ω–æ–≤—ã —ç—Ç–æ–π –¥—É—Ö–æ–≤–Ω–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.",
                c1F: "–†–µ–∑—É–ª—å—Ç–∞—Ç: –†–∞—Å—Ü–≤–µ—Ç –≥–æ—Ä–æ–¥–æ–≤ –∏ –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏.",
                c2T: "–°–∏—Å—Ç–µ–º–∞ –ò–∫—Ç–∞", c2D: "–ö–∞—Ä–∞—Ö–∞–Ω–∏–¥—ã –≤–Ω–µ–¥—Ä–∏–ª–∏ —Å–∏—Å—Ç–µ–º—É –∏–∫—Ç–∞ ‚Äî –ø–æ–∂–∞–ª–æ–≤–∞–Ω–∏–µ –∑–µ–º–ª–∏ –∑–∞ —Å–ª—É–∂–±—É. –≠—Ç–æ —É–∫—Ä–µ–ø–∏–ª–æ –∞—Ä–º–∏—é –∏ —Å–æ–∑–¥–∞–ª–æ –Ω–æ–≤—É—é –ø—Ä–æ—Å–ª–æ–π–∫—É –∑–µ–º–ª–µ–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ (–º—É–∫—Ç–∞). –°—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ –∏ –≤–∞–∫—Ñ—ã ‚Äî –±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–µ–º–ª–∏.",
                c2F: "–¢–∏—Ç—É–ª—ã: –¢–µ–≥–∏–Ω, –ò–ª–µ–∫-—Ö–∞–Ω, –ê—Ä—Å–ª–∞–Ω-—Ö–∞–Ω.",
                c3T: "–¢—é—Ä–∫—Å–∫–∏–π –†–µ–Ω–µ—Å—Å–∞–Ω—Å", c3D: "–Æ—Å—É—Ñ –ë–∞–ª–∞—Å–∞–≥—É–Ω–∏ (¬´–ë–ª–∞–≥–æ–¥–∞—Ç–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ¬ª) –∏ –ú–∞—Ö–º—É–¥ –ö–∞—à–≥–∞—Ä–∏ (¬´–°–ª–æ–≤–∞—Ä—å —Ç—é—Ä–∫—Å–∫–∏—Ö –Ω–∞—Ä–µ—á–∏–π¬ª) –∑–∞–ª–æ–∂–∏–ª–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –æ–±—â–µ—Ç—é—Ä–∫—Å–∫–æ–π –∫—É–ª—å—Ç—É—Ä—ã –∏ —è–∑—ã–∫–∞ –∏–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥.",
                c3F: "–¶–µ–Ω—Ç—Ä—ã: –ë–∞–ª–∞—Å–∞–≥—É–Ω, –ö–∞—à–≥–∞—Ä, –¢–∞—Ä–∞–∑.",
                geoT: "–†–∞—Å–∫–æ–ª –∏ –ü–∞–¥–µ–Ω–∏–µ", geoD: "–í 1040 –≥–æ–¥—É –∏–º–ø–µ—Ä–∏—è —Ä–∞–∑–¥–µ–ª–∏–ª–∞—Å—å –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏. –í XII –≤–µ–∫–µ –æ—Å–ª–∞–±–ª–µ–Ω–Ω–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ –ø–∞–ª–æ –ø–æ–¥ —É–¥–∞—Ä–∞–º–∏ –∫–∞—Ä–∞–∫–∏—Ç–∞–µ–≤ –∏ –≤–æ–π—Å–∫ —Ö–æ—Ä–µ–∑–º—à–∞—Ö–∞ –ú—É—Ö–∞–º–º–µ–¥–∞ –≤ 1212 –≥–æ–¥—É.",
                footer: "¬´–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ –ö–∞—Ä–∞—Ö–∞–Ω–∏–¥–æ–≤ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–æ —Å—Ç–µ–ø–Ω–æ–π –¥—É—Ö –≤ –≤–µ—á–Ω—ã–µ –ø–∞–º—è—Ç–Ω–∏–∫–∏ –∏–∑ –∫–∞–º–Ω—è –∏ –∑–æ–ª–æ—Ç—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–µ–ª–∏–∫–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã.¬ª",
                arch: {
                    dome: { name: "–ö—É–±–±–∞ (–ö—É–ø–æ–ª)", text: "–°–∏–º–≤–æ–ª –Ω–µ–±–µ—Å–Ω–æ–≥–æ —Å–≤–æ–¥–∞. –î–≤–æ–π–Ω—ã–µ –∫—É–ø–æ–ª–∞ –∫–∞—Ä–∞—Ö–∞–Ω–∏–¥—Å–∫–∏—Ö –º–∞–≤–∑–æ–ª–µ–µ–≤ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–ª–∏ –ø—Ä–æ—á–Ω–æ—Å—Ç—å –∏ –≤–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–∏–¥ —Å–æ–æ—Ä—É–∂–µ–Ω–∏–π." },
                    tiles: { name: "–¢–µ—Ä—Ä–∞–∫–æ—Ç–æ–≤—ã–π –¥–µ–∫–æ—Ä", text: "–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –ø–ª–∏—Ç–∫–∞ —Å –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–º–∏ –∏ —ç–ø–∏–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ —É–∑–æ—Ä–∞–º–∏. –ö–∞–∂–¥–∞—è –ø–ª–∏—Ç–∫–∞ –≤—ã—Ä–µ–∑–∞–ª–∞—Å—å –≤—Ä—É—á–Ω—É—é –∏ –æ–±–∂–∏–≥–∞–ª–∞—Å—å –¥–ª—è –ø—Ä–æ—á–Ω–æ—Å—Ç–∏." },
                    arch: { name: "–ü–µ—à—Ç–∞–∫", text: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≤—Ö–æ–¥–Ω–æ–π –ø–æ—Ä—Ç–∞–ª. –ì–ª–∞–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ñ–∞—Å–∞–¥–∞, —É–∫—Ä–∞—à–µ–Ω–Ω—ã–π –∞—è—Ç–∞–º–∏ –∏–∑ –ö–æ—Ä–∞–Ω–∞ –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –æ—Ä–Ω–∞–º–µ–Ω—Ç–∞–º–∏ '–∏—Å–ª–∏–º–∏'." }
                }
            },
            kz: {
                title: "“ö–∞—Ä–∞—Ö–∞–Ω–∏–¥ –º–µ–º–ª–µ–∫–µ—Ç—ñ (942‚Äì1212 –∂–∂.)",
                vizTitle: "–¢–µ—Ä—Ä–∞–∫–æ—Ç–∞ –∫–æ–¥—ã: –ö–µ—Å–µ–Ω–µ",
                vizDesc: "“ö–∞—Ä–∞—Ö–∞–Ω–∏–¥—Ç–µ—Ä —Å”ô—É–ª–µ—Ç—ñ ‚Äî –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –º–µ–Ω ”©–Ω–µ—Ä–¥—ñ“£ —Å–∏–º–±–∏–æ–∑—ã. –°”ô—É–ª–µ—Ç –∂–∞“£–∞–ª—ã“õ—Ç–∞—Ä—ã–Ω –∑–µ—Ä—Ç—Ç–µ—É “Ø—à—ñ–Ω –ø–æ—Ä—Ç–∞–ª —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä—ñ–Ω –±–∞—Å—ã“£—ã–∑.",
                badge: "–ú”ô–¥–µ–Ω–∏ –º“±—Ä–∞–Ω—ã —Ç–∞–ª–¥–∞—É",
                elementTitleDefault: "–¢–∞–ª–¥–∞—É–¥—ã –±–∞—Å—Ç–∞“£—ã–∑",
                elementDescDefault: "–ö“Ø–º–±–µ–∑–¥—ñ, —Å”ô–Ω–¥—ñ–∫ –ø–ª–∏—Ç–∫–∞–ª–∞—Ä–¥—ã –Ω–µ–º–µ—Å–µ –ø–æ—Ä—Ç–∞–ª –∞—Ä–∫–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑.",
                tRel: "–î—ñ–Ω", tSoc: "“ö“±—Ä—ã–ª—ã–º", tSci: "–ú”ô–¥–µ–Ω–∏–µ—Ç",
                c1T: "960 –∂. –ò—Å–ª–∞–º —Ç”©“£–∫–µ—Ä—ñ—Å—ñ", c1D: "–ú“±—Å–∞ “õ–∞“ì–∞–Ω —Ç“±—Å—ã–Ω–¥–∞ –∏—Å–ª–∞–º –º–µ–º–ª–µ–∫–µ—Ç—Ç—ñ–∫ –¥—ñ–Ω –±–æ–ª—ã–ø –∂–∞—Ä–∏—è–ª–∞–Ω–¥—ã. –ë“±–ª —à–µ—à—ñ–º –∫”©—à–ø–µ–ª—ñ–ª–µ—Ä–¥—ñ –±—ñ—Ä—ñ–∫—Ç—ñ—Ä—ñ–ø, –•–∞–ª–∏—Ñ–∞—Ç “ì—ã–ª—ã–º–¥–∞—Ä—ã–Ω–∞ –∂–æ–ª –∞—à—Ç—ã. –°–∞—Ç“±“õ –ë–æ“ì—Ä–∞ —Ö–∞–Ω –æ—Å—ã —Ä—É—Ö–∞–Ω–∏ ”©–∑–≥–µ—Ä—ñ—Å—Ç—ñ“£ –Ω–µ–≥—ñ–∑—ñ–Ω “õ–∞–ª–∞–¥—ã.",
                c1F: "–ù”ô—Ç–∏–∂–µ: “ö–∞–ª–∞–ª–∞—Ä –º–µ–Ω —Å–∞—É–∞—Ç—Ç—ã–ª—ã“õ—Ç—ã“£ –≥“Ø–ª–¥–µ–Ω—É—ñ.",
                c2T: "–ò“õ—Ç–∞ –∂“Ø–π–µ—Å—ñ", c2D: "“ö–∞—Ä–∞—Ö–∞–Ω–∏–¥—Ç–µ—Ä –∏“õ—Ç–∞ –∂“Ø–π–µ—Å—ñ–Ω ‚Äî “õ—ã–∑–º–µ—Ç—ñ “Ø—à—ñ–Ω –∂–µ—Ä —Ç–µ–ª—ñ–º–¥–µ—Ä—ñ–Ω –±–µ—Ä—É–¥—ñ –µ–Ω–≥—ñ–∑–¥—ñ. –ë“±–ª ”ô—Å–∫–µ—Ä–¥—ñ –Ω—ã“ì–∞–π—Ç—ã–ø, –∂–∞“£–∞ –∂–µ—Ä –∏–µ–ª–µ–Ω—É—à—ñ–ª–µ—Ä (–º“±“õ—Ç–∞) —Ç–æ–±—ã–Ω “õ–∞–ª—ã–ø—Ç–∞—Å—Ç—ã—Ä–¥—ã. –°–æ–Ω–¥–∞–π-–∞“õ —É–∞“õ—Ñ—Ç—ã“õ –∂–µ—Ä–ª–µ—Ä –±–æ–ª–¥—ã.",
                c2F: "–õ–∞—É–∞–∑—ã–º–¥–∞—Ä: –¢–µ–≥—ñ–Ω, –ò–ª–µ–∫-—Ö–∞–Ω, –ê—Ä—Å–ª–∞–Ω-—Ö–∞–Ω.",
                c3T: "–¢“Ø—Ä–∫—ñ –†–µ–Ω–µ—Å—Å–∞–Ω—Å—ã", c3D: "–ñ“Ø—Å—ñ–ø –ë–∞–ª–∞—Å–∞“ì“±–Ω (¬´“ö“±—Ç—Ç—ã –±—ñ–ª—ñ–∫¬ª) –∂”ô–Ω–µ –ú–∞—Ö–º“±–¥ “ö–∞—à“õ–∞—Ä–∏ (¬´–î–∏—É–∞–Ω–∏ –ª“±“ì–∞—Ç –∞—Ç-—Ç“Ø—Ä–∫¬ª) –æ—Å—ã –∫–µ–∑–µ“£–¥–µ –±“Ø–∫—ñ–ª—Ç“Ø—Ä–∫—ñ–ª—ñ–∫ –º”ô–¥–µ–Ω–∏–µ—Ç –ø–µ–Ω —Ç—ñ–ª–¥—ñ“£ –Ω–µ–≥—ñ–∑—ñ–Ω “õ–∞–ª–∞–¥—ã.",
                c3F: "–û—Ä—Ç–∞–ª—ã“õ—Ç–∞—Ä: –ë–∞–ª–∞—Å–∞“ì“±–Ω, “ö–∞—à“õ–∞—Ä, –¢–∞—Ä–∞–∑.",
                geoT: "–´–¥—ã—Ä–∞—É –º–µ–Ω “ö“±–ª–¥—ã—Ä–∞—É", geoD: "1040 –∂—ã–ª—ã –∏–º–ø–µ—Ä–∏—è –µ–∫—ñ–≥–µ –±”©–ª—ñ–Ω–¥—ñ. –•–Ü–Ü “ì–∞—Å—ã—Ä–¥–∞ ”ô–ª—Å—ñ—Ä–µ–≥–µ–Ω –º–µ–º–ª–µ–∫–µ—Ç “õ–∞—Ä–∞“õ—ã—Ç–∞–π–ª–∞—Ä–¥—ã“£ —Å–æ“õ“õ—ã—Å—ã–Ω–∞–Ω –∂”ô–Ω–µ 1212 –∂—ã–ª—ã –•–æ—Ä–µ–∑–º—à–∞—Ö –ú“±—Ö–∞–º–º–µ–¥—Ç—ñ“£ “õ—ã—Å—ã–º—ã–Ω–∞–Ω “õ“±–ª–∞–¥—ã.",
                footer: "¬´“ö–∞—Ä–∞—Ö–∞–Ω–∏–¥ –º–µ–º–ª–µ–∫–µ—Ç—ñ –¥–∞–ª–∞ —Ä—É—Ö—ã–Ω —Ç–∞—Å—Ç–∞–Ω “õ–∞–ª–∞–Ω“ì–∞–Ω –º”ô“£–≥—ñ–ª—ñ–∫ –µ—Å–∫–µ—Ä—Ç–∫—ñ—à—Ç–µ—Ä –º–µ–Ω “±–ª—ã ”ô–¥–µ–±–∏–µ—Ç—Ç—ñ“£ –∞–ª—Ç—ã–Ω –±–µ—Ç—Ç–µ—Ä—ñ–Ω–µ –∞–π–Ω–∞–ª–¥—ã—Ä–¥—ã.¬ª",
                arch: {
                    dome: { name: "–ö“Ø–º–±–µ–∑", text: "–ê—Å–ø–∞–Ω ”ô–ª–µ–º—ñ–Ω—ñ“£ –Ω—ã—à–∞–Ω—ã. “ö–∞—Ä–∞—Ö–∞–Ω–∏–¥ –∫–µ—Å–µ–Ω–µ–ª–µ—Ä—ñ–Ω—ñ“£ “õ–æ—Å “õ–∞–±–∞—Ç—Ç—ã –∫“Ø–º–±–µ–∑–¥–µ—Ä—ñ –±–µ—Ä—ñ–∫—Ç—ñ–∫ –ø–µ–Ω –∑”ô—É–ª—ñ–º –∫”©—Ä—ñ–Ω—ñ—Å—Ç—ñ “õ–∞–º—Ç–∞–º–∞—Å—ã–∑ –µ—Ç—Ç—ñ." },
                    tiles: { name: "–¢–µ—Ä—Ä–∞–∫–æ—Ç–∞–ª—ã“õ –¥–µ–∫–æ—Ä", text: "–ì–µ–æ–º–µ—Ç—Ä–∏—è–ª—ã“õ –∂”ô–Ω–µ —ç–ø–∏–≥—Ä–∞—Ñ–∏—è–ª—ã“õ ”©—Ä–Ω–µ–∫—Ç–µ—Ä—ñ –±–∞—Ä –±—ñ—Ä–µ–≥–µ–π –ø–ª–∏—Ç–∫–∞–ª–∞—Ä. ”ò—Ä –ø–ª–∏—Ç–∫–∞ “õ–æ–ª–º–µ–Ω –æ–π—ã–ª—ã–ø, –±–µ—Ä—ñ–∫—Ç—ñ–∫ “Ø—à—ñ–Ω –∫“Ø–π–¥—ñ—Ä—ñ–ª–≥–µ–Ω." },
                    arch: { name: "–ü–µ—à—Ç–∞–∫ (–ü–æ—Ä—Ç–∞–ª)", text: "–û—Ä—Ç–∞–ª—ã“õ –∫—ñ—Ä–µ–±–µ—Ä—ñ—Å –ø–æ—Ä—Ç–∞–ª—ã. “ö“±—Ä–∞–Ω –∞—è—Ç—Ç–∞—Ä—ã–º–µ–Ω –∂”ô–Ω–µ –∫“Ø—Ä–¥–µ–ª—ñ '–∏—Å–ª–∏–º–∏' ”©—Ä–Ω–µ–∫—Ç–µ—Ä—ñ–º–µ–Ω –±–µ–∑–µ–Ω–¥—ñ—Ä—ñ–ª–≥–µ–Ω “õ–∞—Å–±–µ—Ç—Ç—ñ“£ –±–∞—Å—Ç—ã —ç–ª–µ–º–µ–Ω—Ç—ñ." }
                }
            },
            en: {
                title: "Karakhanid State (942‚Äì1212 AD)",
                vizTitle: "Terracotta Code: The Mausoleum",
                vizDesc: "Karakhanid architecture is a symbiosis of math and art. Click on the portal elements to explore architectural innovations.",
                badge: "Cultural Heritage Analysis",
                elementTitleDefault: "Start Analysis",
                elementDescDefault: "Click on the dome, decorative tiles, or the portal arch.",
                tRel: "Religion", tSoc: "Structure", tSci: "Culture",
                c1T: "960 AD Islamic Revolution", c1D: "Under Musa Khagan, Islam was declared the state religion, uniting 200,000 nomad tents. Satuq Boghra Khan laid the foundations for this profound spiritual shift.",
                c1F: "Result: Bloom of cities and literacy.",
                c2T: "The Iqta System", c2D: "The Karakhanids introduced the Iqta system‚Äîgranting land tax rights for military service. They also had waqf lands for mosques and education.",
                c2F: "Titles: Teghin, Ilek-khan, Arslan-khan.",
                c3T: "Turkic Renaissance", c3D: "Yusuf Balasaguni ('Kutadgu Bilig') and Mahmud al-Kashgari ('Compendium of the Turkic Dialects') founded the basis of Turkic identity here.",
                c3F: "Centers: Balasagun, Kashgar, Taraz.",
                geoT: "Split & Collapse", geoD: "In 1040, the empire split in two. In the 12th c., the weakened state fell to the Karakitais and finally Khwarazmian Shah Muhammad in 1212.",
                footer: "¬´The Karakhanid State turned the steppe spirit into eternal stone monuments and golden pages of great literature.¬ª",
                arch: {
                    dome: { name: "Qubba (Dome)", text: "A symbol of the celestial sphere. Double-layered domes provided structural integrity and a majestic appearance." },
                    tiles: { name: "Terracotta Decor", text: "Unique tiles with geometric and calligraphic patterns. Each tile was hand-carved and fired for durability." },
                    arch: { name: "Pishtaq (Portal)", text: "The main entrance portal. The focal point of the facade, decorated with Quranic verses and complex 'islimi' ornaments." }
                }
            }
        };

        let currentLang = 'ru';
        const canvas = document.getElementById('archCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth;
            canvas.height = 550;
            drawMausoleum();
        }

        function drawMausoleum() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const scale = canvas.width / 700;
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;

            // 1. Draw Dome (Qubba)
            ctx.beginPath();
            ctx.arc(cx, 130 * scale, 80 * scale, Math.PI, 0);
            ctx.fillStyle = '#b45309';
            ctx.fill();
            ctx.strokeStyle = '#451a03';
            ctx.lineWidth = 4 * scale;
            ctx.stroke();

            // 2. Main Portal Structure (Pishtaq)
            ctx.fillStyle = '#d97706';
            ctx.fillRect(cx - 150 * scale, 130 * scale, 300 * scale, 350 * scale);
            ctx.strokeRect(cx - 150 * scale, 130 * scale, 300 * scale, 350 * scale);

            // 3. Portal Arch (The Entrance)
            ctx.beginPath();
            ctx.moveTo(cx - 80 * scale, 480 * scale);
            ctx.lineTo(cx - 80 * scale, 250 * scale);
            ctx.quadraticCurveTo(cx, 150 * scale, cx + 80 * scale, 250 * scale);
            ctx.lineTo(cx + 80 * scale, 480 * scale);
            ctx.fillStyle = '#78350f';
            ctx.fill();
            ctx.stroke();

            // 4. Tiles Details (Abstract Pattern)
            ctx.strokeStyle = 'rgba(255,255,255,0.2)';
            ctx.lineWidth = 1 * scale;
            for(let i = -140; i < 140; i += 20) {
                ctx.beginPath();
                ctx.moveTo((cx + i) * scale, 150 * scale);
                ctx.lineTo((cx + i) * scale, 460 * scale);
                ctx.stroke();
            }

            // Highlighting Instruction
            ctx.fillStyle = 'rgba(0,0,0,0.4)';
            ctx.font = 'bold 10px monospace';
            ctx.textAlign = 'center';
            ctx.fillText("TAP ON ARCH, DOME OR WALLS", cx, 50 * scale);
        }

        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const scale = canvas.width / 700;
            const cx = canvas.width / 2;

            let target = null;
            // Detect Dome
            if (y < 130 * scale && Math.abs(x - cx) < 80 * scale) target = 'dome';
            // Detect Arch
            else if (Math.abs(x - cx) < 80 * scale && y > 150 * scale) target = 'arch';
            // Detect Tiles/Walls
            else if (Math.abs(x - cx) < 150 * scale && y > 130 * scale) target = 'tiles';

            if (target) {
                const info = translations[currentLang].arch[target];
                document.getElementById('element-title').innerText = info.name;
                document.getElementById('element-desc').innerText = info.text;
                document.getElementById('info-panel').style.borderColor = (target === 'dome' ? '#b45309' : (target === 'tiles' ? '#d97706' : '#78350f'));
            }
        });

        function setLang(lang) {
            currentLang = lang;
            const t = translations[lang];
            document.getElementById('main-title').innerText = t.title;
            document.getElementById('viz-title').innerText = t.vizTitle;
            document.getElementById('viz-desc').innerText = t.vizDesc;
            document.getElementById('badge').innerText = t.badge;
            document.getElementById('element-title').innerText = t.elementTitleDefault;
            document.getElementById('element-desc').innerText = t.elementDescDefault;
            
            document.getElementById('t-rel').innerText = t.tRel;
            document.getElementById('t-soc').innerText = t.tSoc;
            document.getElementById('t-sci').innerText = t.tSci;

            document.getElementById('c1-t').innerText = t.c1T; document.getElementById('c1-d').innerText = t.c1D;
            document.getElementById('c1-f').innerText = t.c1F;
            document.getElementById('c2-t').innerText = t.c2T; document.getElementById('c2-d').innerText = t.c2D;
            document.getElementById('c2-f').innerText = t.c2F;
            document.getElementById('c3-t').innerText = t.c3T; document.getElementById('c3-d').innerText = t.c3D;
            document.getElementById('c3-f').innerText = t.c3F;

            document.getElementById('geo-t').innerText = t.geoT;
            document.getElementById('geo-d').innerText = t.geoD;
            document.getElementById('footer-text').innerText = t.footer;

            ['ru', 'kz', 'en'].forEach(l => {
                document.getElementById(`btn-${l}`).className = l === lang ? "px-6 py-2 rounded-lg text-sm font-black lang-active" : "px-6 py-2 rounded-lg text-sm font-bold text-orange-700 hover:bg-white transition-all";
            });
            drawMausoleum();
        }

        window.onload = () => { resizeCanvas(); setLang('ru'); };
        window.onresize = resizeCanvas;
    </script>

<script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>







<style data-oi-map-overlay>
.oi-map-btn{
  position:fixed; right:16px; bottom:16px; z-index:9999;
  padding:10px 14px; border-radius:999px; border:1px solid rgba(0,0,0,.15);
  background:#fff; cursor:pointer; font:600 14px/1.1 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  box-shadow:0 8px 20px rgba(0,0,0,.12);
}
.oi-map-backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.72); z-index:10000;
  display:none; align-items:center; justify-content:center; padding:18px;
}
.oi-map-backdrop[aria-hidden="false"]{ display:flex; }
.oi-map-modal{
  width:min(1100px, 100%); height:min(85vh, 900px);
  background:#111; border-radius:14px; overflow:hidden; position:relative;
  box-shadow:0 20px 60px rgba(0,0,0,.35);
}
.oi-map-close{
  position:absolute; top:10px; right:10px; z-index:3;
  width:40px; height:40px; border-radius:999px; border:1px solid rgba(255,255,255,.25);
  background:rgba(0,0,0,.35); color:#fff; cursor:pointer; font-size:22px;
}
.oi-map-viewport{
  width:100%; height:100%; overflow:auto; -webkit-overflow-scrolling:touch;
  touch-action: pan-x pan-y;
  background:#000;
  padding-top:56px; /* –º–µ—Å—Ç–æ –ø–æ–¥ —Ç—É–ª–±–∞—Ä */
}
.oi-map-img{
  display:block;
  transform-origin: 0 0;
  user-select:none; -webkit-user-drag:none;
}
.oi-map-toolbar{
  position:absolute; left:12px; top:12px; right:12px; z-index:2;
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  pointer-events:none;
}
.oi-map-tabs{ display:flex; gap:8px; pointer-events:auto; }
.oi-map-tab{
  width:36px; height:34px; border-radius:10px;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(0,0,0,.35); color:#fff;
  cursor:pointer; font:600 14px system-ui,-apple-system,Segoe UI,Roboto,Arial;
}
.oi-map-tab.is-active{
  background:rgba(255,255,255,.12);
  border-color: rgba(255,255,255,.45);
}
.oi-map-hint{
  pointer-events:none;
  color:#fff; opacity:.85; font:12px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.18);
  padding:8px 10px; border-radius:10px;
}
</style>

<button class="oi-map-btn" type="button" data-oi-map-btn>üó∫Ô∏è –ö–∞—Ä—Ç–∞</button>

<div class="oi-map-backdrop" aria-hidden="true" data-oi-map-backdrop>
  <div class="oi-map-modal" role="dialog" aria-modal="true" aria-label="–ö–∞—Ä—Ç–∞">
    <button class="oi-map-close" type="button" aria-label="–ó–∞–∫—Ä—ã—Ç—å" data-oi-map-close>√ó</button>

    <div class="oi-map-toolbar">
      <div class="oi-map-tabs">
        <button type="button" class="oi-map-tab is-active" data-oi-map-tab="1">1</button>
        <button type="button" class="oi-map-tab" data-oi-map-tab="2">2</button>
        <button type="button" class="oi-map-tab" data-oi-map-tab="3">3</button>
        <button type="button" class="oi-map-tab" data-oi-map-tab="4">4</button>
      </div>
      <div class="oi-map-hint">–ö–æ–ª—ë—Å–∏–∫–æ/—Ç—Ä–µ–∫–ø–∞–¥ ‚Äî –∑—É–º ‚Ä¢ Esc ‚Äî –∑–∞–∫—Ä—ã—Ç—å</div>
    </div>

    <div class="oi-map-viewport" data-oi-map-viewport>
      <img class="oi-map-img" data-oi-map-img data-map="1" src="../../assets/maps/karta_1.png" alt="–ö–∞—Ä—Ç–∞ 1" style="display:block;">
<img class="oi-map-img" data-oi-map-img data-map="2" src="../../assets/maps/karta_2.png" alt="–ö–∞—Ä—Ç–∞ 2" style="display:none;">
<img class="oi-map-img" data-oi-map-img data-map="3" src="../../assets/maps/karta_3.png" alt="–ö–∞—Ä—Ç–∞ 3" style="display:none;">
<img class="oi-map-img" data-oi-map-img data-map="4" src="../../assets/maps/karta_4.png" alt="–ö–∞—Ä—Ç–∞ 4" style="display:none;">
    </div>
  </div>
</div>


<script data-oi-map-overlay>
(function(){
  const btn = document.querySelector('[data-oi-map-btn]');
  const backdrop = document.querySelector('[data-oi-map-backdrop]');
  const closeBtn = document.querySelector('[data-oi-map-close]');
  const viewport = document.querySelector('[data-oi-map-viewport]');
  const tabs = Array.from(document.querySelectorAll('[data-oi-map-tab]'));
  const imgs = Array.from(document.querySelectorAll('[data-oi-map-img][data-map]'));
  if(!btn || !backdrop || !closeBtn || !viewport || imgs.length === 0) return;

  let scale = 1;

  function applyScale(){
    imgs.forEach(img => { img.style.transform = `scale(${scale})`; });
  }
  function openMap(){
    backdrop.setAttribute('aria-hidden','false');
    document.body.style.overflow = 'hidden';
  }
  function closeMap(){
    backdrop.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }
  function showMap(n){
    imgs.forEach(img => {
      img.style.display = (img.getAttribute('data-map') === String(n)) ? 'block' : 'none';
    });
    tabs.forEach(t => t.classList.toggle('is-active', t.getAttribute('data-oi-map-tab') === String(n)));
    viewport.scrollTop = 0;
    viewport.scrollLeft = 0;
  }

  btn.addEventListener('click', openMap);
  closeBtn.addEventListener('click', closeMap);
  backdrop.addEventListener('click', (e)=>{ if(e.target === backdrop) closeMap(); });
  window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeMap(); });

  tabs.forEach(t => t.addEventListener('click', () => showMap(t.getAttribute('data-oi-map-tab'))));

  viewport.addEventListener('wheel', (e)=>{
    if(backdrop.getAttribute('aria-hidden') !== 'false') return;
    e.preventDefault();
    const delta = -Math.sign(e.deltaY) * 0.1;
    scale = Math.min(4, Math.max(0.6, scale + delta));
    applyScale();
  }, {passive:false});

  applyScale();
  showMap(1);
})();
</script>
</body>
</html>