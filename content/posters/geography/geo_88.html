<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antarctica: The White Continent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;600&family=Montserrat:wght@800&display=swap" rel="stylesheet">
    <style>
        body { background: #0f172a; color: white; min-height: 100vh; font-family: 'Inter'; }
        .glass { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); }
        .rounded-custom { border-radius: 2rem; }
        .lang-btn.active { background: #38bdf8; color: #000; font-weight: bold; }
        input[type=range] { accent-color: #38bdf8; }
    </style>
</head>
<body class="p-8">

<!-- КНОПКА НАЗАД -->
<div style="position: fixed; top: 20px; left: 20px; z-index: 10000;">
    <button onclick="goBack()" style="
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 12px 24px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        transition: all 0.3s ease;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    " onmouseover="this.style.transform='translateX(-5px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.6)';" 
       onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)';">
        ← Назад
    </button>
</div>

    <header class="flex justify-between items-center mb-10 border-b border-sky-800 pb-4">
        <div>
            <h1 class="text-4xl font-montserrat text-sky-200 uppercase tracking-widest" id="title"></h1>
            <p class="text-sky-500 font-bold mt-2">90% of World's Ice</p>
        </div>
        <div class="flex gap-2"><button onclick="setL('ru')" id="btn-ru" class="lang-btn px-4 py-1 rounded">RU</button><button onclick="setL('kz')" id="btn-kz" class="lang-btn px-4 py-1 rounded">KZ</button><button onclick="setL('en')" id="btn-en" class="lang-btn px-4 py-1 rounded">EN</button></div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Interactive Freezer -->
        <div class="glass rounded-custom p-6 relative h-[500px] flex flex-col items-center">
            <canvas id="iceCanvas" class="w-full h-full rounded-xl"></canvas>
            <div class="absolute bottom-6 w-3/4 flex flex-col gap-2">
                <div class="flex justify-between text-xs text-sky-300 font-bold uppercase">
                    <span>Warmer</span>
                    <span id="temp-val">-20°C</span>
                    <span>Colder</span>
                </div>
                <input type="range" min="-80" max="0" value="-20" class="w-full" id="tempSlider" oninput="draw()">
            </div>
        </div>

        <div class="flex flex-col justify-center gap-8">
            <div class="glass p-8 rounded-custom border-l-4 border-sky-500">
                <h2 id="h-info" class="text-3xl font-bold mb-4 text-sky-100"></h2>
                <p id="t-info" class="text-lg leading-relaxed text-gray-400"></p>
            </div>
            
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-sky-900/30 p-6 rounded-xl border border-sky-500/20 text-center">
                    <div class="text-4xl font-black text-white">-89.2°C</div>
                    <div class="text-xs uppercase text-sky-400 mt-2">Lowest Temp</div>
                </div>
                <div class="bg-sky-900/30 p-6 rounded-xl border border-sky-500/20 text-center">
                    <div class="text-4xl font-black text-white">0</div>
                    <div class="text-xs uppercase text-sky-400 mt-2">Permanent Residents</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const content = {
            ru: { t: "АНТАРКТИДА", h: "Белый Марс", d: "Самый высокий и холодный материк. Не принадлежит ни одному государству (Договор 1959 года). Здесь сосредоточено 90% льда планеты. Средняя высота — 2040 м (ледниковый купол)." },
            kz: { t: "АНТАРКТИДА", h: "Ақ Марс", d: "Ең биік және суық материк. Ешбір мемлекетке тиесілі емес (1959 жылғы келісім). Мұнда планета мұзының 90%-ы шоғырланған. Орташа биіктігі — 2040 м." },
            en: { t: "ANTARCTICA", h: "The White Mars", d: "The highest and coldest continent. Owned by no nation (1959 Treaty). Holds 90% of Earth's ice. Average elevation is 2040 m (ice dome)." }
        };

        let lang='ru', cx, cvs;

        window.setL = (l) => {
            lang = l;
            document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-'+l).classList.add('active');
            document.getElementById('title').textContent = content[l].t;
            document.getElementById('h-info').textContent = content[l].h;
            document.getElementById('t-info').textContent = content[l].d;
        }

        function draw() {
            const w = cvs.width, h = cvs.height;
            const temp = document.getElementById('tempSlider').value;
            document.getElementById('temp-val').textContent = temp + "°C";
            const freezeFactor = Math.abs(temp) / 80;

            cx.clearRect(0,0,w,h);

            // Background
            const g = cx.createLinearGradient(0,0,0,h);
            g.addColorStop(0, '#0c4a6e'); g.addColorStop(1, '#f0f9ff');
            cx.fillStyle = g; cx.fillRect(0,0,w,h);

            // Ice Crystal Growth Visualization
            cx.fillStyle = 'rgba(255,255,255,0.8)';
            const center = {x: w/2, y: h/2};
            
            // Draw snowflake arms based on temp
            const arms = 6;
            const len = 100 + freezeFactor * 150; // Colder = bigger crystals
            
            cx.strokeStyle = 'white';
            cx.lineWidth = 2 + freezeFactor * 5;
            cx.lineCap = 'round';

            for(let i=0; i<arms; i++) {
                const ang = (i * Math.PI * 2) / arms;
                cx.beginPath();
                cx.moveTo(center.x, center.y);
                cx.lineTo(center.x + Math.cos(ang)*len, center.y + Math.sin(ang)*len);
                cx.stroke();
                
                // Branches
                if(freezeFactor > 0.3) {
                    cx.beginPath();
                    const midX = center.x + Math.cos(ang)*len*0.6;
                    const midY = center.y + Math.sin(ang)*len*0.6;
                    cx.arc(midX, midY, freezeFactor*10, 0, Math.PI*2);
                    cx.fill();
                }
            }
        }

        window.onload = () => {
            cvs = document.getElementById('iceCanvas'); cx = cvs.getContext('2d');
            const rs = () => { cvs.width = cvs.parentElement.clientWidth; cvs.height = cvs.parentElement.clientHeight; draw(); };
            window.addEventListener('resize', rs); rs();
            setL('ru');
        }
    </script>

<script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
<script>
    function goBack() {
        console.log('goBack() вызвана');
        if (typeof bridge !== 'undefined' && bridge) {
            console.log('Bridge найден, вызываю onBackClicked()');
            bridge.onBackClicked();
        } else {
            console.log('Bridge не найден!');
        }
    }

    // Инициализация QWebChannel
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Инициализация QWebChannel...');

        if (typeof QWebChannel !== 'undefined' && typeof qt !== 'undefined') {
            try {
                new QWebChannel(qt.webChannelTransport, function(channel) {
                    window.bridge = channel.objects.bridge;
                    console.log('✅ Bridge подключен!');
                });
            } catch(e) {
                console.error('❌ QWebChannel ошибка:', e);
            }
        } else {
            console.warn('⚠️ QWebChannel или qt не найден');
        }
    });
</script>

</body>
</html>